var Tn=Object.defineProperty;var bt=Object.getOwnPropertySymbols;var Rn=Object.prototype.hasOwnProperty,On=Object.prototype.propertyIsEnumerable;var Dt=(e,t,n)=>t in e?Tn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pe=(e,t)=>{for(var n in t||(t={}))Rn.call(t,n)&&Dt(e,n,t[n]);if(bt)for(var n of bt(t))On.call(t,n)&&Dt(e,n,t[n]);return e};import{A as Un,E as L,a as Ae,C as Mn,e as Pn,d as Vn,b as zn,c as Nn,f as Ie,g as Gn,u as Hn,h as z,i as B,j as jn,o as m,k as A,n as Se,l as d,m as F,p as r,q as me,r as ve,s as i,w as p,t as S,v as Q,x as Ce,y as nt,z as De,B as at,D as It,F as Ct,G as ot,H as st,I as ke,J as te,K as I,L as Ee,M as $,N as O,O as le,P as ie,Q as Xn,R as re,S as Wn,T as ne,U as Fe,V as be,W as Ve,X as ze,Y as wt,Z as Be,_ as Kn,$ as qn,a0 as Jn,a1 as yt,a2 as $t,a3 as At,a4 as Le,a5 as Yn,a6 as Zn,a7 as Qn,a8 as ea,a9 as ta,aa as na,ab as St,ac as aa,ad as oa,ae as sa,af as ua,ag as kt,ah as la,ai as ia,aj as ut,ak as ra,al as ca,am as Bt,an as Lt,ao as da,ap as ma,aq as _a,ar as pa,as as fa,at as ga,au as ha,av as va,aw as Ea,ax as Fa}from"./vendor.df5731b4.js";const ba=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList")for(const o of u.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const u={};return s.integrity&&(u.integrity=s.integrity),s.referrerpolicy&&(u.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?u.credentials="include":s.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(s){if(s.ep)return;s.ep=!0;const u=n(s);fetch(s.href,u)}};ba();const Da="XPoet/picx",Ne="picx-images-hosting",Ia="PicX images hosting repository",Ge="master",Ca="Upload image via PicX(https://github.com/XPoet/picx)",wa="Upload images via PicX(https://github.com/XPoet/picx)",ya="Delete image via PicX(https://github.com/XPoet/picx)",$a="https://api.github.com",Aa=3e5,lt="PICX_",it=`${lt}CONFIG`,xt=`${lt}MANAGEMENT`,Tt=`${lt}SETTINGS`,Rt=5,Ot=30,Ut=18,Mt=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Pt=$a,He=Un.create({baseURL:Pt,timeout:Aa});He.defaults.headers["Content-Type"]="application/json";He.interceptors.request.use(e=>{var n;const t=Mt(it);if(t){const{token:a}=t;((n=e.baseURL)==null?void 0:n.includes(Pt))&&a&&(e.headers.Authorization=`token ${a}`)}return e},e=>Promise.reject(e));He.interceptors.response.use(e=>e,e=>((e==null?void 0:e.response)||L.error({duration:6e3,message:`${e}`}),Promise.reject(e.response)));function K(e){const t={};e.method=e.method.toUpperCase();for(const n in e)n==="params"?e.method==="GET"?t.params=e.params:t.data=e.params:t[n]=e[n];return new Promise(n=>{He.request(t).then(a=>{const{status:s,data:u}=a;n(a&&(s===200||s===201||s===204)?u||"SUCCESS":null)}).catch(a=>{var s;if((t==null?void 0:t.success422)&&(a==null?void 0:a.status)===422)n((a==null?void 0:a.data)||"SUCCESS");else{const u=a==null?void 0:a.status,o=(s=a==null?void 0:a.data)==null?void 0:s.message;(t==null?void 0:t.noShowErrorMsg)||(console.error("PicX Error // ",a),u!==void 0&&o!==void 0&&L.error({duration:6e3,message:`Code: ${u}, Message: ${o}`})),n(null)}})})}const Vt=e=>K({url:"/user",method:"GET",headers:{Authorization:`token ${e}`}}),Sa=(e=Da)=>K({url:`/user/starred/${e}`,method:"PUT",data:{},noShowErrorMsg:!0}),ka=(e,t=1)=>new Promise(async n=>{const a=await K({url:`users/${e}/repos`,method:"GET",params:{type:"owner",sort:"created",direction:"desc",per_page:100,page:t}});a&&a.length?n(a.filter(s=>!s.fork&&!s.private).map(s=>({value:s.name,label:s.name}))):n(null)}),zt=async e=>{const t=[];for(let n=1;n<=3;n++){const a=await ka(e,n);a&&t.push(...a)}return Promise.resolve(t.length?t:null)},Nt=async(e,t=!0)=>{const n=`
# Welcome to use PicX

[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.

PicX is completely open source, and you can use it for free.

If you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).
        `,{owner:a,selectedRepo:s,selectedBranch:u}=e;let o=null;t&&(o=Ae.service({text:"\u6B63\u5728\u521D\u59CB\u5316\u4ED3\u5E93..."})),await K({url:`/repos/${a}/${s}/contents/README.md`,method:"PUT",data:{message:"Init repo via PicX(https://github.com/XPoet/picx)",branch:u,content:window.btoa(n)},noShowErrorMsg:!0})?o==null||o.close():t&&L.error("\u4ED3\u5E93\u521D\u59CB\u5316\u5931\u8D25")},Ba=e=>K({url:"/user/repos",method:"POST",params:{name:Ne,description:Ia,private:!1},headers:{Authorization:`token ${e}`},success422:!0}),xe=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]}),La=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const t=e.split("/");return t.length===1?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}},xa=e=>{if(e==="/")return[];const t=e.split("/"),n=[];let a="";return t.forEach((s,u)=>{a+=`${u>0?"/":""}${s}`,n.unshift(a)}),n};function Gt(e,t,n){var a;return e?t.length===n?e:Gt((a=e.childrenDirs)==null?void 0:a.find(s=>s.dir===t[n]),t,++n):null}const je=(e,t)=>{if(e==="/")return t;const n=e.split("/");return Gt(t,n,0)},Xe=(e,t,n)=>{var a;return n==="dir"?(a=t.childrenDirs)==null?void 0:a.filter(s=>s.type==="dir"):n==="image"?t.imageList.filter(s=>s.type==="image"):[]},Ta=()=>{const e=localStorage.getItem(xt);return e?JSON.parse(e):xe("/","/")},Ra={state:{name:"dirImageListModule",dirObject:Ta()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},n){if(n==="/")return;const a=(l,c,f)=>l?(l.childrenDirs.some(h=>h.dir===c)||l.childrenDirs.push(xe(c,f)),l.childrenDirs.find(h=>h.dir===c)||xe(c,f)):xe(c,f),s=n.split("/");let u="",o=e.dirObject;for(let l=0,c=s.length;l<c;l++){const f=s[l];u+=`${l>0?"/":""}${f}`,o=a(o,f,u),l===0&&t("USER_CONFIG_INFO_ADD_DIR",f)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},n){if(n==="/")return;const a=(o,l,c)=>{if(l==="/")return e.dirObject;const f=o.childrenDirs.find(E=>E.dir===l);if(!f)return o;if(c){const E=o.childrenDirs.findIndex(h=>h.dir===l);E!==-1&&o.childrenDirs.splice(E,1)}return f},s=n.split("/");let u=e.dirObject;s.forEach((o,l)=>{u=a(u,o,l===s.length-1),l===0&&t("USER_CONFIG_INFO_REMOVE_DIR",o)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},n){const a=(u,o,l,c,f=!1)=>{var h;if(!u)return e.dirObject;let E=(h=u.childrenDirs)==null?void 0:h.find(v=>v.dir===o);return E||(E={type:"dir",dir:o,dirPath:l,childrenDirs:[],imageList:[]},u.childrenDirs.push(E)),f&&!E.imageList.some(v=>v.name===c.name)&&E.imageList.push(c),E};let s=e.dirObject;if(n.dir==="/")s.imageList.some(u=>u.name===n.name)||s.imageList.push(n);else{const u=n.dir.split("/");let o="";u.forEach((l,c)=>{o+=`${c>0?"/":""}${l}`,s=a(s,l,o,n,c===u.length-1)})}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},n){const a=(f,E)=>{if(f.length){const h=f.findIndex(v=>v.uuid===E);h!==-1&&f.splice(h,1)}},s=(f,E,h,v)=>{if(!f)return e.dirObject;const g=f.childrenDirs.find(_=>_.dir===E);return g?(g.dir===E&&v&&a(g.imageList,h.uuid),g):e.dirObject},{dir:u,uuid:o}=n;if(u==="/"){a(e.dirObject.imageList,o),t("DIR_IMAGE_LIST_PERSIST");return}const l=u.split("/");let c=e.dirObject;l.forEach((f,E)=>{c=s(c,f,n,E===l.length-1),!c.imageList.length&&!c.childrenDirs.length&&xa(c.dirPath).forEach(v=>{const g=je(v,e.dirObject);if(g&&!g.imageList.length&&!g.childrenDirs.length){const{dirPath:_}=La(v);t("SET_USER_CONFIG_INFO",{viewDir:_}),t("DIR_IMAGE_LIST_REMOVE_DIR",v)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},n){let a=e.dirObject;if(n==="/"){a.imageList=[],a.childrenDirs=[],t("DIR_IMAGE_LIST_PERSIST");return}const s=(o,l,c)=>{var E;if(!o)return e.dirObject;const f=(E=o.childrenDirs)==null?void 0:E.find(h=>h.dir===l);return f?(c&&(f.imageList=[],f.childrenDirs=[]),f):e.dirObject},u=n.split("/");u.forEach((o,l)=>{a=s(a,o,l===u.length-1)}),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(xt,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=xe("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}};var ge;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(ge||(ge={}));var he;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(he||(he={}));var ce;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(ce||(ce={}));var _e;(function(e){e.newBranch="newBranch",e.repoBranch="repoBranch"})(_e||(_e={}));var q;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.repoDir="repoDir"})(q||(q={}));var ee;(function(e){e.large="large",e.default="default",e.small="small"})(ee||(ee={}));var se;(function(e){e.leftTop="leftTop",e.leftBottom="leftBottom",e.rightTop="rightTop",e.rightBottom="rightBottom"})(se||(se={}));var ae;(function(e){e.follow="follow",e.light="light",e.dark="dark"})(ae||(ae={}));var we;(function(e){e[e.parentDir=0]="parentDir",e[e.childDir=1]="childDir",e[e.img=2]="img"})(we||(we={}));const Ht=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},J=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),rt=(e,t)=>{navigator.clipboard.writeText(e).then(()=>{t&&t()})},jt=e=>{for(const t in e)switch(Ht(e[t])){case"object":jt(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},ct=(e,t)=>{for(const n in t)Ht(t[n])!=="object"?e&&(e[n]=t[n]):ct(e[n],t[n])},We=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function n(u){return`00${u}`.substr(u.length)}const a=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${a.getFullYear()}`.substr(4-RegExp.$1.length)));const s={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds()};for(const u in s)if(new RegExp(`(${u})`).test(e)){const o=`${s[u]}`;e=e.replace(RegExp.$1,RegExp.$1.length===1?o:n(o))}return e},Oa=(e,t=500)=>{let n,a;function s(...u){a=u,n||(n=setTimeout(()=>{e(...a),n=void 0},t))}return s};function Ua(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=()=>{const s=new Image;s.setAttribute("crossOrigin","Anonymous"),s.onload=()=>t(s),s.onerror=n,s.src=a.result},a.onerror=n,a.readAsDataURL(e)})}function Ma(e){if(e)e=e.replace("#","");else return"255,255,255";const t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),a=parseInt(e.substring(4,6),16);return`${t}, ${n}, ${a}`}async function Xt(e,t){const{text:n,fontSize:a,position:s,textColor:u,opacity:o}=t,[l,c,f]=Ma(u).split(","),E=await Ua(e),h=document.createElement("canvas"),v=h.getContext("2d");h.width=E.width,h.height=E.height,v.drawImage(E,0,0),v.font=`bold ${a}px Arial`,v.strokeStyle=`rgba(0, 0, 0, ${o})`,v.lineWidth=3,v.fillStyle=`rgba(${l}, ${c}, ${f}, ${o})`;let g=0,_=0;switch(s){case se.leftTop:g=10,_=a+5;break;case se.rightTop:g=h.width-v.measureText(n).width-10,_=a+5;break;case se.leftBottom:g=10,_=h.height-15;break;case se.rightBottom:g=h.width-v.measureText(n).width-10,_=h.height-15;break}return v.strokeText(n,g,_),v.fillText(n,g,_),new Promise(D=>{h.toBlob(y=>{if(!y)D(null);else{const b=new File([y],e.name,{type:e.type});D(b)}},e.type)})}const Wt=()=>({uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isHashRename:!0,isRename:!1,isPrefix:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}}),Pa=(e,t)=>({type:"image",uuid:J(),dir:t,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,checked:!1});async function Va(e,t){e.deleting=!0;const{owner:n,selectedRepo:a}=t,{path:s,sha:u}=e;return new Promise(async o=>{const l=await ln(n,a,s,u);e.deleting=!1,l?(o(!0),await V.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await V.dispatch("DIR_IMAGE_LIST_REMOVE",e)):o(!1)})}const Te=(e,t=!1)=>{e.forEach(n=>{n.deleting=t})};async function za(e,t){Te(e,!0);const{owner:n,selectedRepo:a,selectedBranch:s}=t,u=await sn(n,a,s);if(!u)throw Te(e,!1),new Error("\u83B7\u53D6\u5206\u652F\u4FE1\u606F\u5931\u8D25");const o=await rn(n,a,e.map(f=>({path:f.path,sha:null})),u);if(!o)throw Te(e,!1),new Error("\u521B\u5EFA tree \u5931\u8D25");const l=await cn(n,a,o,u);if(!l)throw Te(e,!1),new Error("\u521B\u5EFA commit \u5931\u8D25");if(!await dn(n,a,s,l.sha))throw Te(e,!1),new Error("\u66F4\u65B0 ref \u5931\u8D25");e.forEach(f=>{f.deleting=!1,V.dispatch("UPLOAD_IMG_LIST_REMOVE",f.uuid),V.dispatch("DIR_IMAGE_LIST_REMOVE",f)})}async function Na(e,t){if(e.length===1)return await Va(e[0],t)?he.deleted:he.deleteFail;try{return await za(e,t),he.allDeleted}catch(n){return console.error(n),he.deleteFail}}function Ga(e,t){const n=document.createElement("canvas"),a=n.getContext("2d"),s=new Image;return s.crossOrigin="Anonymous",s.src=e,new Promise(u=>{s.onload=()=>{const{width:o}=s,{height:l}=s;n.width=o,n.height=l,a==null||a.drawImage(s,0,0,o,l);const c=n.toDataURL(`image/${t}`);u(c)}})}function Ha(e){return new Promise(t=>{K({baseURL:"",url:e,method:"GET",responseType:"blob"}).then(n=>{if(n){const a=new FileReader;a.onload=()=>{const s=a.result;t(s)},a.onerror=()=>{t(null)},a.readAsDataURL(n)}else t(null)}).catch(()=>{t(null)})})}function Re(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>{const a=n.result;t(a)},n.onerror=()=>t(null)})}function dt(e){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=e.name,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}const Kt=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},mt=e=>{const t=e.lastIndexOf(".");return e.slice(t+1)},_t=e=>/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|svg|x-icon|vnd.microsoft.icon)$/.test(e),ja=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),Xa=e=>/(png|jpg|jpeg|webp|avif)$/.test(e),ye=e=>e&&Number((e/1024).toFixed(0)),Wa=e=>new Promise(async t=>{e||t(null),_t(e.type)||(L.error(`${e.name} \u4E0D\u662F\u56FE\u7247\u683C\u5F0F`),t(null));const n=await Re(e)||"";ye(n.length)>=Ot*1024&&(L.error(`${e.name} \u8D85\u8FC7 ${Ot} MB\uFF0C\u8DF3\u8FC7\u9009\u62E9`),t(null)),t({uuid:J(),base64:n,file:e})}),qt=async(e,t)=>ja(e.type)?new Mn(e,{encoderState:{type:t,options:Pn[t].meta.defaultOptions},processorState:Vn,preprocessorState:zn}).process():e,pt=(e,t,n)=>{var u;const a=n.imageLinkType.selected,s=(u=n.imageLinkType.presetList.find(o=>o.name===a))==null?void 0:u.rule;if(s){const{owner:o,selectedRepo:l,selectedBranch:c}=t;return s.replaceAll("{{owner}}",o).replaceAll("{{repo}}",l).replaceAll("{{branch}}",c).replaceAll("{{path}}",e.path)}return null},Jt=(e,t,n)=>{var a;if(n.imageLinkFormat.enable){const s=n.imageLinkFormat.selected,u=(a=n.imageLinkFormat.presetList.find(o=>o.name===s))==null?void 0:a.format;if(u)return u.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},Yt=(e,t=6500)=>{Nn({type:"success",title:"\u590D\u5236\u6210\u529F",message:e,duration:t,offset:50})},Zt=()=>`${ft()==="mac"?"Command":"Ctrl"} + V`,Ke=(e,t,n,a=!1)=>{const s=Jt(pt(e,t,n),e.name,n);s?rt(s,()=>{const u=`${e.name} \u56FE\u7247\u94FE\u63A5\u5DF2${a?"\u81EA\u52A8":""}\u590D\u5236\u5230\u7CFB\u7EDF\u526A\u8D34\u677F\uFF0C\u53EF\u4F7F\u7528\u5FEB\u6377\u952E ${Zt()} \u8FDB\u884C\u7C98\u8D34\u3002`;Yt(u)}):L.error("\u590D\u5236\u5931\u8D25")},Qt=(e,t,n,a=!1)=>{if((e==null?void 0:e.length)>0){let s="";e.forEach((u,o)=>{s+=`${Jt(pt(u,t,n),u.name,n)}${o<e.length-1?`
`:""}`}),rt(s,()=>{const u=`\u5DF2${a?"\u81EA\u52A8":""}\u590D\u5236 ${e.length} \u5F20\u56FE\u7247\u94FE\u63A5\u5230\u7CFB\u7EDF\u526A\u8D34\u677F\uFF0C\u53EF\u4F7F\u7528\u5FEB\u6377\u952E ${Zt()} \u8FDB\u884C\u7C98\u8D34\u3002`;Yt(u)})}else console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},en=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,ft=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},tn=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:_e.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:q.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem(it);return t&&(ct(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===q.autoDir&&(e.selectedDir=We("yyyyMMdd"))),e},Ka=e=>{const{selectedDir:t,selectedBranch:n,dirMode:a}=e.userConfigInfo;if(a==="newDir"){const s=t.split("");let u=0,o="";const l=[" ",".","\u3001",",","\uFF0C","!","\uFF1F","?"];for(let c=0;c<s.length&&(l.some(f=>f===s[c])&&(s[c]="-"),s[c]==="/"&&(u+=1),!(u>=Rt));c++)o+=s[c];e.userConfigInfo.selectedDir=o}e.userConfigInfo.selectedBranch=n.replace(/\s+/g,"-")},qa={state:{userConfigInfo:tn()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=tn()},SET_USER_CONFIG_INFO({state:e,dispatch:t},n){for(const a in n)e.userConfigInfo.hasOwnProperty(a)&&(e.userConfigInfo[a]=n[a]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},n){e.userConfigInfo.dirList.some(a=>a.value===n)||(e.userConfigInfo.dirList.push({label:n,value:n}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},n){const{dirList:a}=e.userConfigInfo;if(a.some(s=>s.value===n)){const s=a.findIndex(u=>u.value===n);a.splice(s,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){Ka(e),localStorage.setItem(it,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){jt(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},Ja={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:n,checked:a}=t;a&&e.imgCardArr.forEach(s=>{s.uuid===n&&(s.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(t=>t.checked)}},Ya={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},gt={defaultHash:!0,prefixNaming:{enable:!1,prefix:""},compress:{enable:!0,encoder:ce.webP},theme:{mode:ae.follow},elementPlusSize:ee.default,imageLinkType:{selected:"Staticaly",presetList:[{id:J(),name:"Staticaly",rule:"https://cdn.staticaly.com/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:J(),name:"ChinaJsDelivr",rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:J(),name:"jsDelivr",rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:J(),name:"GitHub",rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"}]},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:se.rightBottom,textColor:"#FFFFFF",opacity:.5}},Za=()=>{const e=Mt(Tt);return e&&ct(gt,e),gt},nn=(e,t,n)=>{const a=t==="add"?"\u6DFB\u52A0":"\u7F16\u8F91",s=[];if(e.rule.includes("{{owner}}")||s.push("{{owner}}"),e.rule.includes("{{repo}}")||s.push("{{repo}}"),e.rule.includes("{{branch}}")||s.push("{{branch}}"),!s.length){n(!0);return}if(e.rule.includes("{{path}}")){let u=`\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u7F3A\u5C11 ${s.join("\u3001")}\uFF0C\u662F\u5426\u786E\u8BA4${a}\uFF1F`;t==="edit"&&(u=`\u6CE8\u610F\uFF1A\u5F53\u524D\u7F16\u8F91\u7684\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u7F3A\u5C11 ${s.join("\u3001")}`),Ie.confirm(u,`${a}\u63D0\u793A`,{type:"warning",showClose:t==="add",showCancelButton:t==="add"}).then(()=>{n(!0)}).catch(()=>{console.log(`\u53D6\u6D88${a}`),n(!1)})}else L.error(`${a}\u5931\u8D25\uFF0C\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u5FC5\u987B\u5305\u542B {{path}}`)},Qa={state:{userSettings:Za()},actions:{SET_USER_SETTINGS({state:e},t){for(const n in t)e.userSettings.hasOwnProperty(n)&&(e.userSettings[n]=t[n])},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){e.userSettings.imageLinkType.presetList.some(s=>s.name===n.name)?L.error("\u6DFB\u52A0\u5931\u8D25\uFF0C\u8BE5\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u89C4\u5219\u5DF2\u5B58\u5728"):nn(n,"add",s=>{s&&(e.userSettings.imageLinkType.presetList.push(n),t("USER_SETTINGS_PERSIST"))})},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){nn(n,"edit",a=>{if(a){const s=e.userSettings.imageLinkType.presetList.find(u=>u.id===n.id);s&&(s.rule=n.rule,t("USER_SETTINGS_PERSIST"))}})},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},n){const a=e.userSettings.imageLinkType.presetList;a.splice(a.findIndex(s=>s.id===n),1),t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(Tt,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=gt}},getters:{getUserSettings:e=>e.userSettings}},eo={state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},t){e.toolboxImageList.unshift(t)},TOOLBOX_IMG_LIST_REMOVE({state:e},t){if(e.toolboxImageList.length>0){const n=e.toolboxImageList.findIndex(a=>a.uuid===t);n!==-1&&e.toolboxImageList.splice(n,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},to={state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},t){e.uploadImageList.unshift(t)},UPLOAD_IMG_LIST_REMOVE({state:e},t){if(e.uploadImageList.length>0){const n=e.uploadImageList.findIndex(a=>a.uuid===t);n!==-1&&e.uploadImageList[n].uploadStatus.progress===0&&e.uploadImageList.splice(n,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}},V=Gn({modules:{dirImageListModule:Ra,userConfigInfoModule:qa,imageCardModule:Ja,uploadAreaActiveModule:Ya,userSettingsModule:Qa,toolboxImageListModule:eo,uploadImageListModule:to},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),an=Symbol("vuex-store");function Y(){return Hn(an)}const on=(e,t="")=>{const{owner:n,selectedRepo:a,selectedBranch:s}=e;return new Promise(async u=>{const o=await K({url:`/repos/${n}/${a}/contents/${t}`,method:"GET",params:{ref:s}});o&&o.length?u(o.filter(l=>l.type==="dir").map(l=>({value:l.name,label:l.name}))):u(null)})},qe=(e,t="")=>{const{owner:n,selectedRepo:a,selectedBranch:s}=e;return new Promise(async u=>{const o=await K({url:`/repos/${n}/${a}/contents/${t}`,method:"GET",params:{"no-cache":J(),ref:s}});o&&o.length?(o.filter(l=>l.type==="dir").forEach(l=>V.dispatch("DIR_IMAGE_LIST_ADD_DIR",l.path)),setTimeout(()=>{o.filter(l=>l.type==="file"&&_t(mt(l.name))).forEach(l=>{V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",Pa(l,t))})},120),u(!0)):u(null)})},sn=(e,t,n)=>K({url:`/repos/${e}/${t}/branches/${n}`,method:"GET"}),un=(e,t)=>new Promise(async n=>{const a=await K({url:`/repos/${e}/${t}/branches`,method:"GET"});a&&a.length?n(a.filter(s=>!s.protected).map(s=>({value:s.name,label:s.name})).reverse()):n(null)}),no=async(e,t,n)=>{const{owner:a,selectedRepo:s,branchList:u}=e,o=Ae.service({text:`\u6B63\u5728\u65B0\u5EFA ${t} \u5206\u652F...`});try{let l="";const c=await K({url:`/repos/${a}/${s}/git/refs/heads/${u[0].value}`,method:"GET"});if(c&&(l=c.object.sha),!l){o.close(),L.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}let f="";const E=await K({url:`/repos/${a}/${s}/git/refs`,method:"POST",params:{ref:`refs/heads/${t}`,sha:l}});if(E&&(f=E.object.sha),!f){o.close(),L.error("\u65B0\u5EFA\u5206\u652F\u5931\u8D25");return}await K({url:`/repos/${a}/${s}/git/refs/heads/${t}`,method:"PATCH",params:{force:!0,sha:f}})&&n()}catch(l){console.error(l)}},ln=(e,t,n,a)=>K({url:`/repos/${e}/${t}/contents/${n}`,method:"DELETE",data:{owner:e,repo:t,path:n,message:ya,sha:a}}),ao=(e,t)=>K({url:e,method:"PUT",data:t}),oo=(e,t,n)=>K({url:`/repos/${t}/${n}/git/blobs`,method:"POST",params:{owner:t,repo:n,content:(e.base64.compressBase64||e.base64.watermarkBase64||e.base64.originalBase64).split(",")[1],encoding:"base64"}}),rn=(e,t,n,a)=>{var s,u,o;return K({url:`/repos/${e}/${t}/git/trees`,method:"POST",params:{tree:n.map(l=>({path:l.path,mode:"100644",type:"blob",sha:l.sha})),base_tree:((o=(u=(s=a==null?void 0:a.commit)==null?void 0:s.commit)==null?void 0:u.tree)==null?void 0:o.sha)||null}})},cn=(e,t,n,a)=>K({url:`/repos/${e}/${t}/git/commits`,method:"POST",params:{tree:n.sha,parents:[a.commit.sha],message:wa}}),dn=(e,t,n,a)=>K({url:`/repos/${e}/${t}/git/refs/heads/${n}`,method:"PATCH",params:{sha:a}}),mn=z({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:ee.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!0}},setup(e){const t=Y(),n=B(()=>t.getters.getUserConfigInfo).value,a={lazy:!0,checkStrictly:!0,async lazyLoad(u,o){const{level:l,pathLabels:c}=u;let f;l===0?f=n.dirList:f=await on(n,c.join("/")),o(f?f.map(E=>({value:E.value,label:E.label,leaf:l>=Rt-1})):[])}},s=u=>{n.selectedDirList=u,n.selectedDir=u.join("/"),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,o)=>{const l=jn;return m(),A(l,{style:Se({width:e.elWidth}),size:e.elSize,debounce:500,props:a,key:e.elKey,modelValue:d(n).selectedDirList,"onUpdate:modelValue":o[0]||(o[0]=c=>d(n).selectedDirList=c),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:e.elClearable,onChange:s},null,8,["style","size","modelValue","clearable"])}}}),so={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},uo=r("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1),lo=[uo];function io(e,t){return m(),F("svg",so,lo)}var _n={name:"ep-refresh",render:io};var G=(e,t)=>{const n=e.__vccOpts||e;for(const[a,s]of t)n[a]=s;return n};const ro=z({__name:"refresh-config",props:{boxWidth:{type:Number,default:20},dataType:{type:String,default:""}},setup(e){const t=e,n=Y(),a=B(()=>n.getters.getUserConfigInfo).value,s=B(()=>t.dataType==="repo"?"\u4ED3\u5E93":"\u5206\u652F"),u=async()=>{const o=Ae.service({lock:!0,text:`\u6B63\u5728\u52A0\u8F7D ${s.value} \u6570\u636E ...`}),{owner:l,selectedRepo:c}=a;if(t.dataType==="repo"){const f=await zt(l);f&&(a.repoList=f)}else if(t.dataType==="branch"){const f=await un(l,c);f&&(a.branchList=f)}o.close(),await n.dispatch("USER_CONFIG_INFO_PERSIST")};return(o,l)=>{const c=_n,f=me,E=ve;return m(),F("div",{class:"refresh-config-box",style:Se({width:e.boxWidth+"rem"})},[i(E,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+s.value+" \u6570\u636E"},{default:p(()=>[i(f,{class:"icon",onClick:u},{default:p(()=>[i(c)]),_:1})]),_:1},8,["content"])],4)}}});var co=G(ro,[["__scopeId","data-v-372aba4c"]]);const N=B(()=>V.getters.getUserConfigInfo).value,mo=()=>{V.dispatch("LOGOUT")},fe=()=>{V.dispatch("USER_CONFIG_INFO_PERSIST")};function pn(e){N.logined=!0,N.owner=e.login,N.name=e.name,N.email=e.email,N.avatarUrl=e.avatar_url,fe()}const _o=()=>{N.selectedRepo="",N.repoList=[],N.selectedBranch="",N.branchMode=_e.repoBranch,N.branchList=[],N.selectedDir="",N.dirMode=q.repoDir,N.dirList=[]},po=async()=>{const{selectedDir:e,dirMode:t}=N;let n="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(e===""){switch(t){case q.newDir:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case q.repoDir:n=`\u8BF7\u9009\u62E9 ${N.selectedRepo} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:n="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}L.warning(n)}else await Oe.push("/upload")},fo=async()=>{const{token:e}=N;if(!e){L.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A");return}const t=Ae.service({lock:!0,text:"\u6B63\u5728\u81EA\u52A8\u914D\u7F6E..."}),n=await Vt(N.token);if(console.log("getGitHubUserInfo >> ",n),!n){t.close(),L.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}pn(n);const a=await Ba(N.token);if(console.log("createRepo >> ",a),!a){t.close(),L.error("\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5");return}N.repoList=[{value:Ne,label:Ne}],N.selectedRepo=Ne,N.branchList=[{value:Ge,label:Ge}],N.selectedBranch=Ge,N.branchMode=_e.repoBranch,N.selectedDir=We("yyyyMMdd"),N.dirMode=q.autoDir,N.dirList=[],fe(),await Nt(N,!1),t.close(),L.success("\u81EA\u52A8\u914D\u7F6E\u6210\u529F"),await Oe.push("/upload")};const go={class:"page-container config-page-container"},ho=z({__name:"my-config",setup(e){const t=Y(),n=S(!1),a=S(!1),s=S(!1),u=S(32),o=B(()=>t.getters.getUserConfigInfo).value,l=B(()=>t.getters.getUserLoginStatus).value,c=B(()=>t.getters.getUserSettings).value,f=B(()=>!o.token||!o.owner),E=B(()=>c.elementPlusSize===ee.large?"right":"top"),h=B(()=>n.value||a.value||s.value),v=S(null),g=S(null),_=S(""),D=S("repoDirCascaderKey"),y=x=>{var w;switch(x){case q.rootDir:o.selectedDir="/";break;case q.autoDir:o.selectedDir=We("yyyyMMdd");break;case q.newDir:o.selectedDir="xxx",(w=v.value)==null||w.focus();break;case q.repoDir:const{dirList:P}=o;P.length?(o.selectedDir=P[0].value,o.selectedDirList=[P[0].value]):o.selectedDir="";break;default:o.selectedDir="/";break}fe()};async function b(x){const w=await zt(x);console.log("getAllRepoList >> ",w),n.value=!1,w?(o.repoList=w,fe()):L.error("\u4ED3\u5E93\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}async function C(){a.value=!0;const x=await on(o);console.log("getDirInfoList >> ",x),a.value=!1,x&&(o.dirList=x),fe()}const R=x=>{var U;const w=o.selectedBranch,P=o.branchList[0].value;switch(x){case _e.newBranch:o.dirMode=q.newDir,o.selectedBranch="",o.selectedDir="",(U=g.value)==null||U.focus();break;case _e.repoBranch:w!==P&&(o.selectedBranch=P,C());break;default:o.selectedBranch="";break}fe()};async function k(x){s.value=!0;const{owner:w,dirMode:P}=o,U=await un(w,x);console.log("getBranchInfoList >> ",U),s.value=!1,U?(U.length>0?(o.branchList=U,o.selectedBranch=o.branchList[0].value,o.branchMode=_e.repoBranch,await C()):(o.selectedBranch=Ge,o.branchMode=_e.newBranch,await Nt(o)),y(P),fe()):L.error("\u5206\u652F\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5")}async function T(){if(!o.token){L.error("GitHub Token \u4E0D\u80FD\u4E3A\u7A7A");return}f.value||_o(),n.value=!0;const x=await Vt(o.token);if(console.log("getGitHubUserInfo >> ",x),!x){L.error("\u7528\u6237\u4FE1\u606F\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u786E\u8BA4 Token \u662F\u5426\u6B63\u786E");return}pn(x),await b(x.login)}function X(x){o.branchList=[],o.dirList=[],t.dispatch("DIR_IMAGE_LOGOUT"),k(x),fe()}async function Z(x){o.selectedBranch=x,await C(),D.value=o.selectedBranch,o.selectedDir=o.dirList[0].value,o.selectedDirList=[o.selectedDir],fe()}const j=()=>{const x=_.value,w=o.branchList;x?w.find(P=>P.value===x)?L.warning(`${x} \u5206\u652F\u5DF2\u5B58\u5728\uFF0C\u8BF7\u5728\u5206\u652F\u5217\u8868\u4E2D\u9009\u62E9`):no(o,x,()=>{L.success(`\u65B0\u5EFA ${x} \u6210\u529F`),o.branchList.push({value:x,label:x})}):L.error("\u65B0\u5EFA\u5206\u652F\u4E0D\u80FD\u4E3A\u7A7A")};return Q(()=>l,x=>{x||(n.value=!1,a.value=!1,s.value=!1)}),(x,w)=>{const P=Ce,U=nt,ue=De,oe=ve,pe=at,W=It,Ue=Ct,de=co,Me=ot,Ln=st,xn=mn,et=ke;return m(),F("div",go,[i(pe,{"label-width":"70rem","label-position":E.value},{default:p(()=>[i(U,{label:"Token"},{default:p(()=>[i(P,{modelValue:d(o).token,"onUpdate:modelValue":w[0]||(w[0]=M=>d(o).token=M),clearable:"",autofocus:!d(o).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),i(U,{class:"operation"},{default:p(()=>[i(oe,{placement:"top",content:"\u9009\u62E9\u5DF2\u6709\u7684 GitHub \u4ED3\u5E93"},{default:p(()=>[i(ue,{disabled:h.value,plain:"",type:"primary","native-type":"submit",onClick:w[1]||(w[1]=Ee(M=>T(),["prevent"]))},{default:p(()=>[$(O(f.value?"":"\u91CD\u65B0")+"\u624B\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1}),i(oe,{placement:"top",content:"\u81EA\u52A8\u521B\u5EFA GitHub \u4ED3\u5E93\uFF08\u9002\u5408\u65B0\u7528\u6237\uFF09"},{default:p(()=>[i(ue,{plain:"",disabled:h.value,type:"primary",onClick:w[2]||(w[2]=Ee(M=>d(fo)(),["prevent"]))},{default:p(()=>[$(O(f.value?"":"\u91CD\u65B0")+"\u4E00\u952E\u81EA\u52A8\u914D\u7F6E ",1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["label-position"]),d(o).token&&d(o).owner?te((m(),A(pe,{key:0,"label-width":"70rem","label-position":E.value,"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u7528\u6237\u4FE1\u606F..."},{default:p(()=>[d(o).owner?(m(),A(U,{key:0,label:"\u7528\u6237\u540D"},{default:p(()=>[i(P,{modelValue:d(o).owner,"onUpdate:modelValue":w[3]||(w[3]=M=>d(o).owner=M),readonly:""},null,8,["modelValue"])]),_:1})):I("",!0),d(o).email?(m(),A(U,{key:1,label:"\u90AE\u7BB1"},{default:p(()=>[i(P,{modelValue:d(o).email,"onUpdate:modelValue":w[4]||(w[4]=M=>d(o).email=M),readonly:""},null,8,["modelValue"])]),_:1})):I("",!0),d(o).repoList.length?(m(),A(U,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:p(()=>[i(Ue,{modelValue:d(o).selectedRepo,"onUpdate:modelValue":w[5]||(w[5]=M=>d(o).selectedRepo=M),filterable:!0,style:Se({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:X},{default:p(()=>[(m(!0),F(le,null,ie(d(o).repoList,(M,tt)=>(m(),A(W,{key:tt,label:M.label,value:M.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),i(de,{"box-width":u.value,"data-type":"repo"},null,8,["box-width"])]),_:1})):I("",!0)]),_:1},8,["label-position"])),[[et,n.value]]):I("",!0),d(o).token&&d(o).selectedRepo&&d(o).branchList.length?te((m(),A(pe,{key:1,"label-width":"70rem","label-position":E.value,"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u5206\u652F\u4FE1\u606F..."},{default:p(()=>[(d(o).selectedRepo,I("",!0)),d(o).branchList.length&&d(o).branchMode===d(_e).repoBranch?(m(),A(U,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:p(()=>[i(Ue,{modelValue:d(o).selectedBranch,"onUpdate:modelValue":w[7]||(w[7]=M=>d(o).selectedBranch=M),filterable:!0,style:Se({width:"calc(100% - "+u.value+"rem)"}),placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:Z},{default:p(()=>[(m(!0),F(le,null,ie(d(o).branchList,(M,tt)=>(m(),A(W,{key:tt,label:M.label,value:M.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","style"]),i(de,{"box-width":u.value,"data-type":"branch"},null,8,["box-width"])]),_:1})):I("",!0),d(o).branchMode===d(_e).newBranch?(m(),A(U,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:p(()=>[i(P,{modelValue:_.value,"onUpdate:modelValue":w[8]||(w[8]=M=>_.value=M),onBlur:j,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F...",ref_key:"newBranchInputRef",ref:g},null,8,["modelValue"])]),_:1})):I("",!0)]),_:1},8,["label-position"])),[[et,s.value]]):I("",!0),d(o).token&&d(o).selectedBranch?te((m(),A(pe,{key:2,"label-width":"70rem","label-position":E.value,"element-loading-text":"\u6B63\u5728\u52A0\u8F7D\u76EE\u5F55\u4FE1\u606F..."},{default:p(()=>[d(o).selectedBranch?(m(),A(U,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:p(()=>[i(Ln,{modelValue:d(o).dirMode,"onUpdate:modelValue":w[9]||(w[9]=M=>d(o).dirMode=M),onChange:y},{default:p(()=>[i(oe,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:p(()=>[i(Me,{label:"newDir"},{default:p(()=>[$("\u65B0\u5EFA\u76EE\u5F55")]),_:1})]),_:1}),i(oe,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+d(o).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:p(()=>[i(Me,{label:"rootDir"},{default:p(()=>[$("\u6839\u76EE\u5F55")]),_:1})]),_:1},8,["content"]),i(oe,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:p(()=>[i(Me,{label:"autoDir"},{default:p(()=>[$("\u81EA\u52A8\u76EE\u5F55")]),_:1})]),_:1}),d(o).dirList.length&&d(o).branchMode!=="newBranch"?(m(),A(oe,{key:0,content:"\u9009\u62E9 "+d(o).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:p(()=>[i(Me,{label:"repoDir"},{default:p(()=>[$(" \u9009\u62E9 "+O(d(o).selectedRepo)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):I("",!0)]),_:1},8,["modelValue"])]),_:1})):I("",!0),d(o).dirMode==="autoDir"?(m(),A(U,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:p(()=>[i(P,{modelValue:d(o).selectedDir,"onUpdate:modelValue":w[10]||(w[10]=M=>d(o).selectedDir=M),readonly:""},null,8,["modelValue"])]),_:1})):I("",!0),d(o).dirMode==="rootDir"?(m(),A(U,{key:2,label:"\u6839\u76EE\u5F55"},{default:p(()=>[i(P,{modelValue:d(o).selectedDir,"onUpdate:modelValue":w[11]||(w[11]=M=>d(o).selectedDir=M),readonly:""},null,8,["modelValue"])]),_:1})):I("",!0),d(o).dirMode==="newDir"?(m(),A(U,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:p(()=>[i(P,{ref_key:"newDirInputRef",ref:v,modelValue:d(o).selectedDir,"onUpdate:modelValue":w[12]||(w[12]=M=>d(o).selectedDir=M),onInput:w[13]||(w[13]=M=>d(fe)()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):I("",!0),d(o).dirList.length&&d(o).dirMode==="repoDir"&&d(o).branchMode!=="newBranch"?(m(),A(U,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:p(()=>[i(xn,{"el-key":D.value,"el-size":d(c).elementPlusSize},null,8,["el-key","el-size"])]),_:1})):I("",!0)]),_:1},8,["label-position"])),[[et,a.value]]):I("",!0),d(o).token?(m(),A(pe,{key:3,"label-width":"70rem","label-position":E.value},{default:p(()=>[i(U,{class:"operation"},{default:p(()=>[d(o).owner?(m(),A(ue,{key:0,plain:"",disabled:h.value,type:"warning",onClick:w[14]||(w[14]=M=>d(mo)())},{default:p(()=>[$(" \u91CD\u7F6E ")]),_:1},8,["disabled"])):I("",!0),d(o).selectedRepo?(m(),A(ue,{key:1,plain:"",disabled:h.value,type:"success",onClick:w[15]||(w[15]=M=>d(po)())},{default:p(()=>[$(" \u786E\u8BA4 ")]),_:1},8,["disabled"])):I("",!0)]),_:1})]),_:1},8,["label-position"])):I("",!0)])}}});var vo=G(ho,[["__scopeId","data-v-2aa853fc"]]);const Eo={key:0,class:"selected-info-bar-box"},Fo={class:"info-item repo"},bo={key:0,class:"info-item branch"},Do={class:"info-item dir"},Io=z({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=Y(),n=B(()=>t.getters.getUserConfigInfo),a=B(()=>t.getters.getUserSettings);return(s,u)=>{const o=Xn,l=mn;return n.value.selectedRepo?(m(),F("div",Eo,[r("span",Fo,[$(" \u4ED3\u5E93\uFF1A "),i(o,{"disable-transitions":""},{default:p(()=>[$(O(n.value.selectedRepo),1)]),_:1})]),n.value.selectedBranch?(m(),F("span",bo,[$(" \u5206\u652F\uFF1A "),i(o,{"disable-transitions":""},{default:p(()=>[$(O(n.value.selectedBranch),1)]),_:1})])):I("",!0),r("span",Do,[$(" \u76EE\u5F55\uFF1A "),n.value.dirMode!==d(q).repoDir||e.barType==="management"?(m(),A(o,{key:0,"disable-transitions":""},{default:p(()=>[$(O(e.barType==="management"?n.value.viewDir:n.value.selectedDir),1)]),_:1})):I("",!0),n.value.dirMode===d(q).repoDir&&e.barType==="upload"?(m(),A(l,{key:1,"el-size":a.value.elementPlusSize===d(ee).large?d(ee).default:a.value.elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):I("",!0)])])):I("",!0)}}});var fn=G(Io,[["__scopeId","data-v-dc55c6ba"]]);const Co={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},wo=r("path",{fill:"currentColor",d:"M544 864V672h128L512 480L352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0 1 64 624c0-123.136 93.12-223.488 212.608-237.248A239.808 239.808 0 0 1 512 192a239.872 239.872 0 0 1 235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 0 1-240 240c-5.376 0-10.56-1.28-16-1.6v1.6H544z"},null,-1),yo=[wo];function $o(e,t){return m(),F("svg",Co,yo)}var Ao={name:"ep-upload-filled",render:$o};const gn=e=>(Fe("data-v-13df4475"),e=e(),be(),e),So=["onDrop","onPaste"],ko=gn(()=>r("label",{for:"input-file-selector"},null,-1)),Bo={key:0,class:"upload-area-tips"},Lo=gn(()=>r("div",{class:"text"},"\u62D6\u62FD / \u7C98\u8D34 / \u70B9\u51FB\u6B64\u5904\u9009\u62E9\u56FE\u7247",-1)),xo=["src"],To=z({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:t,emit:n}){const a=Y(),s=B(()=>a.getters.getUploadAreaActive),u=S({uuid:"",base64:""}),o=S([]),l=()=>{const _=o.value.length,D=_>0?o.value[_-1]:{uuid:"",base64:""};u.value={uuid:D.uuid,base64:D.base64}},c=async _=>{if(!!_.length){o.value=[];for(const D of _){const y=await Wa(D);y&&o.value.push(y)}l(),a.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0),n("getImgList",o.value)}},f=async _=>{const D=_.target;await c(D.files),D.value="",D.value=D.defaultValue},E=async _=>{await c(_.dataTransfer.files)},h=async _=>{const D=Array.from(_.clipboardData.items).filter(y=>y.kind==="file"&&_t(y.type)).map(y=>y.getAsFile());await c(D)},v=()=>{o.value=[],u.value.uuid="",u.value.base64=""},g=_=>{const D=o.value.findIndex(y=>y.uuid===_);D!==-1&&o.value.splice(D,1),_===u.value.uuid&&l()};return re(()=>{window.addEventListener("paste",h)}),Wn(()=>{window.removeEventListener("paste",h)}),t({reset:v,remove:g}),(_,D)=>{const y=Ao,b=me;return m(),F("div",{class:ne(["getting-images-container",{focus:s.value&&u.value.base64,disabled:e.disabled}]),onDragover:D[0]||(D[0]=Ee(()=>{},["prevent"])),onDrop:Ee(E,["stop","prevent"]),onPaste:Ee(h,["stop"])},[ko,r("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:f,multiple:"multiple"},null,32),u.value.base64?I("",!0):(m(),F("div",Bo,[i(b,{class:"icon"},{default:p(()=>[i(y)]),_:1}),Lo])),u.value.base64?(m(),F("img",{key:1,class:"preview-img",src:u.value.base64},null,8,xo)):I("",!0)],42,So)}}});var Je=G(To,[["__scopeId","data-v-13df4475"]]);const Ro=B(()=>V.getters.getUserSettings).value,Oo=async e=>{const{starred:t}=e;t||await Sa()&&await V.dispatch("SET_USER_SETTINGS",{starred:!0})},Uo=e=>{const t=Wt();t.uuid=e.uuid,t.base64.originalBase64=e.base64,t.fileInfo.originalFile=e.file;const{prefixNaming:n,defaultHash:a}=Ro,s=e.uuid,u=e.file.name.lastIndexOf("."),o=e.file.name.slice(0,u),l=e.file.name.slice(u+1);return t.filename.initName=o,t.filename.name=n.enable?`${n.prefix}${o}`:o,t.filename.prefixName=n.prefix,t.filename.hash=s,t.filename.suffix=l,t.filename.final=a?`${t.filename.name}.${s}.${l}`:`${t.filename.name}.${l}`,t.filename.isHashRename=a,t.filename.isPrefix=n.enable,t},hn=(e,t,n)=>{var u;let a=n.selectedDir;((u=t==null?void 0:t.reUploadInfo)==null?void 0:u.isReUpload)&&(a=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const s={checked:!1,type:"image",uuid:t.uuid,dir:a,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};t.uploadedImg=s,V.dispatch("DIR_IMAGE_LIST_ADD_DIR",a),V.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",s)},Mo=(e,t)=>{var l;const{owner:n,selectedRepo:a,selectedDir:s}=e,u=t.filename.final;let o=u;return s!=="/"&&(o=`${s}/${u}`),((l=t==null?void 0:t.reUploadInfo)==null?void 0:l.isReUpload)&&(o=t.reUploadInfo.path),`/repos/${n}/${a}/contents/${o}`};async function Po(e,t){const{selectedBranch:n,selectedRepo:a,selectedDir:s,owner:u}=e,o=[];for(const v of t){v.uploadStatus.uploading=!0;const g=await oo(v,u,a);g?o.push(Pe({img:v},g)):(v.uploadStatus.uploading=!1,L.error(`${v.filename.final} \u4E0A\u4F20\u5931\u8D25`))}const l=await sn(u,a,n);if(!l)return Promise.resolve(!1);const c=s==="/"?"":`${s}/`,f=await rn(u,a,o.map(v=>({sha:v.sha,path:`${c}${v.img.filename.final}`})),l);if(!f)return Promise.resolve(!1);const E=await cn(u,a,f,l);return!E||!await dn(u,a,n,E.sha)?Promise.resolve(!1):(o.forEach(v=>{const g=v.img.filename.final;hn({name:g,sha:v.sha,path:`${c}${g}`,size:0},v.img,e)}),Promise.resolve(!0))}function vn(e,t){const{selectedBranch:n,email:a,owner:s}=e,u={message:Ca,branch:n,content:(t.base64.compressBase64||t.base64.watermarkBase64||t.base64.originalBase64).split(",")[1]};return a&&(u.committer={name:s,email:a}),t.uploadStatus.uploading=!0,new Promise(async o=>{const l=await ao(Mo(e,t),u);if(console.log("uploadSingleImage >> ",l),t.uploadStatus.uploading=!1,l){const{name:c,sha:f,path:E,size:h}=l.content;hn({name:c,sha:f,path:E,size:h},t,e),o(!0)}else o(!1)})}const Vo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},zo=r("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1),No=[zo];function Go(e,t){return m(),F("svg",Vo,No)}var En={name:"ep-check",render:Go};const Ho={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},jo=r("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64zm384-578.304V704h-64V247.296L237.248 490.048L192 444.8L508.8 128l316.8 316.8l-45.312 45.248L544 253.696z"},null,-1),Xo=[jo];function Wo(e,t){return m(),F("svg",Ho,Xo)}var Fn={name:"ep-upload",render:Wo};const Ko={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},qo=r("path",{fill:"currentColor",d:"M352 480h320a32 32 0 1 1 0 64H352a32 32 0 0 1 0-64z"},null,-1),Jo=r("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768a384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896a448 448 0 0 1 0 896z"},null,-1),Yo=[qo,Jo];function Zo(e,t){return m(),F("svg",Ko,Yo)}var bn={name:"ep-remove",render:Zo};const Qo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},es=r("path",{fill:"currentColor",d:"M672 192L288 511.936L672 832z"},null,-1),ts=[es];function ns(e,t){return m(),F("svg",Qo,ts)}var as={name:"ep-caret-left",render:ns};const os={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ss=r("path",{fill:"currentColor",d:"m192 384l320 384l320-384z"},null,-1),us=[ss];function ls(e,t){return m(),F("svg",os,us)}var is={name:"ep-caret-bottom",render:ls};const ht=(e,t)=>{e?t.filename.name=`${t.filename.prefixName}${t.filename.initName}`:t.filename.name=`${t.filename.initName}`,t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},Dn=(e,t)=>{e?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},rs=(e,t)=>{t.filename.isRename=e,e?t.filename.name=t.filename.newName.trim().replace(/\s+/g,"-"):ht(t.filename.isPrefix,t),t.filename.isHashRename?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},cs=async(e,t)=>{const{watermark:n,compress:a}=t;let s=e.fileInfo.originalFile;n.enable&&n.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=Xa(e.fileInfo.originalFile.type)?await Xt(e.fileInfo.originalFile,n):e.fileInfo.originalFile,s=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await Re(s),e.beforeUploadStatus.watermarking=!1),a.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await qt(s,a.encoder),s=e.fileInfo.compressFile,e.base64.compressBase64=await Re(s),e.filename.suffix=mt(s.name),e.beforeUploadStatus.compressing=!1)};const ds=["element-loading-text"],ms={class:"before-upload-handle-container"},_s={class:"img-name-box"},ps={class:"img-name text-ellipsis"},fs={class:"operate-item"},gs={class:"operate-item"},hs={key:0,class:"operate-item"},vs={key:1,class:"img-info-box"},Es={class:"file-size-box"},Fs={key:0,class:"finial-file-size file-size-item"},bs={class:"last-modified"},Ds=z({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const n=e,a=Y(),s=S(null),u=B(()=>a.getters.getUserSettings).value,o=B(()=>a.getters.getUserConfigInfo).value,l=S(""),c=Ve({isHash:!1,prefixNaming:!1,isRename:!1,newName:""}),f=S(!0),E=g=>{t("remove",g)},h=()=>{n.imgObj.filename.newName=c.newName,setTimeout(()=>{var g;(g=s.value)==null||g.focus()},100),rs(c.isRename,n.imgObj)},v=()=>{const{defaultHash:g,prefixNaming:_}=u;n.imgObj.uploadStatus.progress===0&&(n.imgObj.filename.isHashRename=g,n.imgObj.filename.isPrefix=_.enable,n.imgObj.filename.prefixName=_.prefix,ht(_.enable,n.imgObj),Dn(g,n.imgObj),c.isHash=n.imgObj.filename.isHashRename,c.prefixNaming=n.imgObj.filename.isPrefix,c.isRename=n.imgObj.filename.isRename,c.newName=n.imgObj.filename.newName)};return Q(()=>n.imgObj.uploadStatus,g=>{g.uploading&&(l.value="\u6B63\u5728\u4E0A\u4F20...")},{deep:!0,immediate:!0}),re(async()=>{await cs(n.imgObj,u),v()}),(g,_)=>{var w,P,U,ue,oe,pe;const D=ze,y=is,b=as,C=me,R=ve,k=wt,T=Ce,X=bn,Z=Fn,j=En,x=ke;return m(),F("div",{class:ne(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploading:e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress!==100,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[te((m(),F("div",{class:"img-show-container","element-loading-text":l.value},[i(D,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])],8,ds)),[[x,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),r("div",ms,[r("div",_s,[r("span",ps,O(e.imgObj.filename.final||e.imgObj.filename.name),1),e.imgObj.uploadStatus.progress===0?(m(),A(R,{key:0,placement:"top",offset:8,content:f.value?"\u5C55\u5F00":"\u6298\u53E0"},{default:p(()=>[i(C,{class:"fold-btn",onClick:_[0]||(_[0]=W=>f.value=!f.value)},{default:p(()=>[f.value?I("",!0):(m(),A(y,{key:0})),f.value?(m(),A(b,{key:1})):I("",!0)]),_:1})]),_:1},8,["content"])):I("",!0)]),e.imgObj.uploadStatus.progress===0?(m(),F("div",{key:0,class:ne(["img-name-operate-box",{folded:f.value}])},[r("div",fs,[i(k,{label:"\u54C8\u5E0C\u5316",modelValue:c.isHash,"onUpdate:modelValue":_[1]||(_[1]=W=>c.isHash=W),onChange:_[2]||(_[2]=W=>d(Dn)(W,e.imgObj))},null,8,["modelValue"])]),r("div",gs,[i(k,{label:"\u91CD\u547D\u540D",modelValue:c.isRename,"onUpdate:modelValue":_[3]||(_[3]=W=>c.isRename=W),onChange:h},null,8,["modelValue"]),e.imgObj.filename.isRename?(m(),A(T,{key:0,class:"rename-input",size:"small",modelValue:c.newName,"onUpdate:modelValue":_[4]||(_[4]=W=>c.newName=W),onInput:h,maxlength:d(Ut),ref_key:"renameInputRef",ref:s,clearable:""},null,8,["modelValue","maxlength"])):I("",!0)]),!e.imgObj.filename.isRename&&d(u).prefixNaming.enable&&d(u).prefixNaming.prefix?(m(),F("div",hs,[i(k,{label:"\u547D\u540D\u524D\u7F00",modelValue:c.prefixNaming,"onUpdate:modelValue":_[5]||(_[5]=W=>c.prefixNaming=W),onChange:_[6]||(_[6]=W=>d(ht)(W,e.imgObj))},null,8,["modelValue"])])):I("",!0)],2)):I("",!0),e.imgObj.uploadStatus.progress===0?(m(),F("div",vs,[r("div",Es,[r("span",{class:ne(["original-file-size file-size-item",{"del-line":(P=(w=e.imgObj.fileInfo)==null?void 0:w.compressFile)==null?void 0:P.size}])},O(d(ye)(e.imgObj.fileInfo.originalFile.size))+" KB ",3),((ue=(U=e.imgObj.fileInfo)==null?void 0:U.compressFile)==null?void 0:ue.size)?(m(),F("span",Fs,O(d(ye)((pe=(oe=e.imgObj.fileInfo)==null?void 0:oe.compressFile)==null?void 0:pe.size))+" KB ",1)):I("",!0)]),r("span",bs,O(d(We)("yyyy-MM-dd hh:mm",e.imgObj.fileInfo.originalFile.lastModified)),1)])):I("",!0)]),e.imgObj.uploadStatus.progress===100?(m(),F("div",{key:0,class:"after-upload-handle-container flex-center",onClick:_[7]||(_[7]=W=>d(Ke)(e.imgObj.uploadedImg,d(o),d(u)))}," \u70B9\u51FB\u590D\u5236\u56FE\u7247\u94FE\u63A5 ")):I("",!0),e.imgObj.uploadStatus.progress===0?(m(),A(R,{key:1,placement:"top",offset:8,content:"\u5220\u9664"},{default:p(()=>[i(C,{class:"del-img-btn",onClick:_[8]||(_[8]=W=>E(e.imgObj.uuid))},{default:p(()=>[i(X)]),_:1})]),_:1})):I("",!0),r("div",{class:ne(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0,uploaded:!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100}])},[i(C,null,{default:p(()=>[!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===0?(m(),A(Z,{key:0})):I("",!0),!e.imgObj.uploadStatus.uploading&&e.imgObj.uploadStatus.progress===100?(m(),A(j,{key:1})):I("",!0)]),_:1})],2)],2)}}});var Is=G(Ds,[["__scopeId","data-v-c76392c4"]]);const Cs={class:"upload-page-container"},ws={key:0,class:"upload-page-left page-container",style:{width:"300rem"}},ys={class:"row-item"},$s={class:"content-box"},As={class:"row-item"},Ss={class:"content-box upload-area-status"},ks={key:0},Bs={key:0,class:"row-item"},Ls={class:"content-box",style:{"text-align":"right"}},xs={class:"shortcut-key"},Ts={class:"shortcut-key"},Rs=z({__name:"upload-image",setup(e){const t=Y(),n=Be(),a=S(null),s=B(()=>t.getters.getUserConfigInfo).value,u=B(()=>t.getters.getUserSettings).value,o=B(()=>t.getters.getUserLoginStatus),l=S([]),c=S(!1),f=B(()=>ft()==="mac"?"Command":"Ctrl"),E=C=>{C.forEach(R=>{t.dispatch("UPLOAD_IMG_LIST_ADD",Uo(R))})},h=()=>{var C;(C=a.value)==null||C.reset()},v=async C=>{if(C.length===1)return await vn(s,C[0])?ge.uploaded:ge.uploadFail;if(C.length>1)return await Po(s,C)?ge.allUploaded:ge.uploadFail},g=async(C,R=!1)=>{h(),R?Qt(C,s,u,!0):Ke(C[0],s,u,!0),await t.dispatch("SET_USER_CONFIG_INFO",{viewDir:s.selectedDir}),await Oo(u)},_=async()=>{const{token:C,selectedRepo:R,selectedDir:k}=s;if(!C){L.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E"),await n.push("/config");return}if(!R){L.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93"),await n.push("/config");return}if(!k){L.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A"),await n.push("/config");return}const T=l.value.filter(j=>j.uploadStatus.progress===0);if(T.length===0){L.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247");return}c.value=!0;const X=await v(T);c.value=!1;const Z=T.filter(j=>j.uploadStatus.progress===100).map(j=>j.uploadedImg);switch(X){case ge.uploaded:L.success("\u56FE\u7247\u4E0A\u4F20\u6210\u529F"),await g(Z);break;case ge.allUploaded:L.success("\u56FE\u7247\u6279\u91CF\u4E0A\u4F20\u6210\u529F"),await g(Z,!0);break;case ge.uploadFail:L.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}},D=()=>{c.value=!1,t.dispatch("UPLOAD_IMG_LIST_RESET"),h()},y=C=>{var R;t.dispatch("UPLOAD_IMG_LIST_REMOVE",C),(R=a.value)==null||R.remove(C)};Q(()=>o,C=>{!C&&D()}),Q(()=>t.state.uploadImageListModule.uploadImageList,C=>{l.value=C},{immediate:!0,deep:!0});const b=()=>{document.addEventListener("keydown",C=>{const R=C.keyCode||C.which||C.charCode,k=C.ctrlKey||C.metaKey;k&&R===65&&l.value.length&&(D(),C.preventDefault()),k&&R===83&&(c.value||(_(),C.preventDefault()))})};return re(()=>{b()}),(C,R)=>{const k=Je,T=fn,X=De;return m(),F("div",Cs,[l.value.length&&(d(u).elementPlusSize===d(ee).large||d(u).elementPlusSize===d(ee).default)?(m(),F("div",ws,[(m(!0),F(le,null,ie(l.value,(Z,j)=>(m(),F("div",{class:"uploaded-item",key:j+Z.uuid},[i(Is,{"img-obj":Z,onRemove:R[0]||(R[0]=x=>y(x))},null,8,["img-obj"])]))),128))])):I("",!0),r("div",{class:ne(["upload-page-right page-container",{"has-left":l.value.length}])},[r("div",ys,[r("div",$s,[i(k,{disabled:c.value,ref_key:"gettingImagesRef",ref:a,onGetImgList:E},null,8,["disabled"])])]),r("div",As,[r("div",Ss,[i(T),l.value.length?(m(),F("div",ks," \u5DF2\u4E0A\u4F20\uFF1A"+O(l.value.filter(Z=>Z.uploadStatus.progress===100).length)+" / "+O(l.value.length),1)):I("",!0)])]),l.value.length?(m(),F("div",Bs,[r("div",Ls,[i(X,{disabled:c.value,plain:"",type:"warning",onClick:D},{default:p(()=>[$(" \u91CD\u7F6E "),r("span",xs,O(f.value)+" + A",1)]),_:1},8,["disabled"]),i(X,{disabled:c.value,plain:"",type:"primary",onClick:_},{default:p(()=>[$(" \u4E0A\u4F20 "),r("span",Ts,O(f.value)+" + S",1)]),_:1},8,["disabled"])])])):I("",!0)],2)])}}}),Os={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Us=r("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224a112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224z"},null,-1),Ms=[Us];function Ps(e,t){return m(),F("svg",Os,Ms)}var Vs={name:"ep-more-filled",render:Ps};const zs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ns=r("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296c-44.096 0-108.992 44.736-148.48 101.504c0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04c67.84 0 107.904-43.648 147.456-100.416z"},null,-1),Gs=[Ns];function Hs(e,t){return m(),F("svg",zs,Gs)}var js={name:"ep-info-filled",render:Hs};const Xs={class:"copy-image-link-box"},Ws={class:"left"},Ks={class:"btn-box right"},qs=z({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,n=B(()=>V.getters.getUserSettings).value,a=B(()=>V.getters.getUserConfigInfo).value;let s=S(t.imgObj).value;const u=()=>{Ke(s,a,n)};return Kn(()=>{s=t.imgObj}),(o,l)=>{const c=js,f=me,E=ve;return m(),F("div",Xs,[r("div",Ws,[i(E,{content:"\u8BF7\u5728'\u6211\u7684\u8BBE\u7F6E'\u8FDB\u884C\u56FE\u7247\u94FE\u63A5\u76F8\u5173\u914D\u7F6E",placement:"top"},{default:p(()=>[i(f,null,{default:p(()=>[i(c)]),_:1})]),_:1})]),r("div",Ks,[i(E,{content:"\u70B9\u51FB\u590D\u5236 "+d(n).imageLinkType.selected+" \u56FE\u7247\u94FE\u63A5",placement:"top"},{default:p(()=>[r("span",{class:"btn-item flex-center",onClick:u}," \u590D\u5236\u94FE\u63A5 ")]),_:1},8,["content"])])])}}});var Js=G(qs,[["__scopeId","data-v-43a8b34a"]]);const Ys={class:"image-box"},Zs={class:"info-box"},Qs={class:"image-info"},eu={key:0,class:"rename-operate"},tu={key:1,class:"filename"},nu={class:"copy-link-box"},au={class:"operation-box"},ou={class:"operation-left"},su={class:"operation-right"},uu={class:"operation-btn"},lu=z({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const t=e,n=Y(),a=qn(),s=B(()=>n.getters.getUserConfigInfo).value,u=B(()=>n.getters.getUserSettings).value,o=B(()=>a.path==="/management"),l=B(()=>pt(t.imageObj,s,u)),c=S(),f=S(""),E=S(!1),h=S(!1),v=S(!1),g=(k,T=!1)=>{T||(k.deleting=!0);const{owner:X,selectedRepo:Z}=s,{path:j,sha:x}=k;return new Promise(async w=>{await ln(X,Z,j,x)?(T?(E.value=!1,L.success("\u66F4\u65B0\u6210\u529F")):L.success("\u5220\u9664\u6210\u529F"),await n.dispatch("DIR_IMAGE_LIST_REMOVE",k),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",k.uuid),w(!0)):w(!1)})},_=k=>{Ie.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${k.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{g(k)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},D=k=>{k.checked=!k.checked,n.commit("IMAGE_CARD",{imageObj:k})},y=async k=>{E.value=!0,f.value=Kt(k.name),setTimeout(()=>{var T;(T=c.value)==null||T.focus()},100)},b=async()=>{var X;const{imageObj:k}=t;if(!f.value){L.error("\u56FE\u7247\u540D\u4E0D\u80FD\u4E3A\u7A7A"),(X=c.value)==null||X.focus();return}if(f.value===Kt(k.name)){L.error("\u56FE\u7247\u540D\u65E0\u6539\u53D8"),E.value=!1;return}const T=async()=>{const Z=Ae.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),j=mt(k.name),x=J(),w=`${f.value}${u.defaultHash?`.${x}`:""}.${j}`;let P;if(j.includes("svg")?P=await Ha(l.value||""):P=await Ga(l.value||"",j),P){const U=Wt();U.uuid=x,U.base64.originalBase64=P,U.filename.final=w,U.reUploadInfo.isReUpload=!0,U.reUploadInfo.dir=k.dir;let ue=w;k.dir!=="/"&&(ue=`${k.dir}/${w}`),U.reUploadInfo.path=ue,await vn(s,U)?(f.value="",await g(k,!0),await n.dispatch("UPLOAD_IMG_LIST_REMOVE",k.uuid)):L.error("\u91CD\u547D\u540D\u5931\u8D25")}else L.error("\u91CD\u547D\u540D\u5931\u8D25");Z.close(),E.value=!1};Ie.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${f.value} \uFF1F`,"\u63D0\u793A",{type:"info"}).then(()=>{T()}).catch(()=>{console.log("\u53D6\u6D88\u91CD\u547D\u540D"),E.value=!1})},C=k=>{v.value=k},R=k=>{Ie.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${k.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${ye(k.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(k,T)=>{const X=ze,Z=Ce,j=De,x=Jn,w=Js,P=En,U=me,ue=Vs,oe=yt,pe=$t,W=At,Ue=ke;return te((m(),F("div",{class:ne(["image-card",{checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:T[6]||(T[6]=de=>h.value=!0),onMouseleave:T[7]||(T[7]=de=>h.value=!1)},[r("div",Ys,[i(X,{src:l.value,fit:"cover",loading:"lazy",lazy:"","data-fancybox":"gallery"},null,8,["src"])]),r("div",Zs,[r("div",Qs,[E.value?(m(),F("div",eu,[i(Z,{size:"small",class:"rename-input",modelValue:f.value,"onUpdate:modelValue":T[0]||(T[0]=de=>f.value=de),clearable:"",ref_key:"renameInputRef",ref:c,maxlength:d(Ut)},null,8,["modelValue","maxlength"]),i(x,{size:"small"},{default:p(()=>[i(j,{icon:d(Yn),onClick:T[1]||(T[1]=de=>E.value=!1)},null,8,["icon"]),i(j,{icon:d(Zn),onClick:Ee(b,["prevent"])},null,8,["icon","onClick"])]),_:1})])):(m(),F("div",tu,O(e.imageObj.name),1))])]),r("div",nu,[i(w,{"img-obj":e.imageObj},null,8,["img-obj"])]),te(r("div",au,[r("div",ou,[o.value?(m(),F("div",{key:0,class:ne([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:T[2]||(T[2]=de=>D(e.imageObj))},[e.imageObj.checked?(m(),A(U,{key:0},{default:p(()=>[i(P)]),_:1})):I("",!0)],2)):I("",!0)]),r("div",su,[i(W,{size:"default",trigger:"click",onVisibleChange:C},{dropdown:p(()=>[i(pe,null,{default:p(()=>[i(oe,{onClick:T[3]||(T[3]=de=>_(e.imageObj))},{default:p(()=>[$(" \u5220\u9664 ")]),_:1}),i(oe,{onClick:T[4]||(T[4]=Ee(de=>y(e.imageObj),["self"]))},{default:p(()=>[$(" \u91CD\u547D\u540D ")]),_:1}),i(oe,{onClick:T[5]||(T[5]=de=>R(e.imageObj))},{default:p(()=>[$(" \u5C5E\u6027 ")]),_:1})]),_:1})]),default:p(()=>[r("div",uu,[i(U,null,{default:p(()=>[i(ue)]),_:1})])]),_:1})])],512),[[Le,h.value||v.value||e.imageObj.checked]])],34)),[[Ue,e.imageObj.deleting]])}}});var iu=G(lu,[["__scopeId","data-v-0b7cf4ea"]]);const In=e=>(Fe("data-v-fba37bd4"),e=e(),be(),e),ru=In(()=>r("div",{class:"icon"},[r("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[r("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),r("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),cu={key:1,class:"text"},du={key:2,class:"icon"},mu=In(()=>r("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[r("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),_u=[mu],pu={key:3,class:"text"},fu=z({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=e,n=Y(),a=B(()=>n.getters.getUserConfigInfo).value,s=()=>{const{folderObj:u,mode:o}=t;if(o==="back"){const l=a.viewDir;if(l==="/")return;const c=l.split("/");c.length===1?a.viewDir="/":c.length>1&&(c.length-=1,a.viewDir=c.join("/"))}o==="dir"&&(a.viewDir=u.dirPath),n.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,o)=>{const l=ve;return m(),F("div",{class:"folder-card",onDblclick:s},[e.mode==="dir"?(m(),A(l,{key:0,content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:p(()=>[ru]),_:1})):I("",!0),e.mode==="dir"?(m(),F("div",cu,O(e.folderObj.dir),1)):I("",!0),e.mode==="back"?(m(),F("div",du,_u)):I("",!0),e.mode==="back"?(m(),F("div",pu,"\u53CC\u51FB\u540E\u9000")):I("",!0)],32)}}});var Cn=G(fu,[["__scopeId","data-v-fba37bd4"]]);const gu={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},hu=r("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1),vu=[hu];function Eu(e,t){return m(),F("svg",gu,vu)}var Fu={name:"ep-delete",render:Eu};const bu={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Du=r("path",{fill:"currentColor",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64h64z"},null,-1),Iu=r("path",{fill:"currentColor",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64H384zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64z"},null,-1),Cu=[Du,Iu];function wu(e,t){return m(),F("svg",bu,Cu)}var yu={name:"ep-copy-document",render:wu};const $u={key:0,class:"selector-wrapper"},Au={class:"selector-left-box"},Su={class:"item"},ku={class:"selector-right-box"},Bu=z({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const t=e,n=Y(),a=S(!1),s=B(()=>n.getters.getImageCardCheckedArr),u=B(()=>n.getters.getUserConfigInfo).value,o=B(()=>n.getters.getUserSettings).value,l=B(()=>s.value.length||0);Q(()=>l.value,v=>{const g=t.currentDirImageList.length;a.value=v===g});const c=()=>{Qt(s.value,u,o)},f=()=>{t.currentDirImageList.forEach(v=>{v.checked&&(v.checked=!1)})},E=()=>{var v,g;((v=s.value)==null?void 0:v.length)>0?Ie.confirm(`\u5DF2\u9009\u4E2D ${(g=s.value)==null?void 0:g.length} \u5F20\u56FE\u7247\uFF0C\u662F\u5426\u6279\u91CF\u5220\u9664\uFF1F`,"\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{const _=await Na(s.value,u);_===he.deleted&&L.success("\u5220\u9664\u6210\u529F"),_===he.allDeleted&&L.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),_===he.deleteFail&&L.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):L.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},h=()=>{let v=[];t.currentDirImageList.forEach(g=>{g.checked=a.value}),v=t.currentDirImageList,n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:v})};return re(()=>{h()}),(v,g)=>{const _=wt,D=yu,y=me,b=ve,C=Fu;return l.value?(m(),F("div",$u,[r("div",Au,[i(_,{label:a.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=R=>a.value=R),onChange:h},null,8,["label","modelValue"]),r("div",Su,"\u5DF2\u9009\u62E9 "+O(l.value)+" \u5F20\u56FE\u7247",1),r("div",{class:"item cancel-select-btn",onClick:f},"\u53D6\u6D88\u9009\u62E9")]),r("div",ku,[i(b,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u94FE\u63A5"},{default:p(()=>[i(y,{class:"btn-icon",onClick:c},{default:p(()=>[i(D)]),_:1})]),_:1}),i(b,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:p(()=>[i(y,{class:"btn-icon",onClick:E},{default:p(()=>[i(C)]),_:1})]),_:1})])])):I("",!0)}}});var Lu=G(Bu,[["__scopeId","data-v-26050e8d"]]);const xu=e=>(Fe("data-v-fac724d4"),e=e(),be(),e),Tu={class:"page-container management-page-container"},Ru={class:"content-container"},Ou={class:"top"},Uu={class:"left"},Mu={class:"right flex-start"},Pu={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},Vu={key:0,class:"image-management-item"},zu=xu(()=>r("div",{style:{width:"100%"}},null,-1)),Nu=z({__name:"imgs-management",setup(e){const t=Y(),n=Be(),a=B(()=>t.getters.getUserConfigInfo).value,s=B(()=>t.getters.getUserLoginStatus).value,u=B(()=>t.getters.getDirObject).value,o=S(new Date().getTime()),l=S(!1),c=S([]),f=S([]),E=S(!1);async function h(_){l.value=!0;const D=je(_,u);if(D){const y=Xe(_,D,"dir"),b=Xe(_,D,"image");!y.length&&!b.length?await qe(a,_):(c.value=y,f.value=b,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:f.value}))}else await qe(a,_);l.value=!1}async function v(){const{selectedDir:_,viewDir:D,dirMode:y}=a;if(D===""&&((y===q.newDir||y===q.autoDir)&&!je(_,u)&&(a.selectedDir="/",a.dirMode="rootDir"),a.selectedDir?a.viewDir=a.selectedDir:a.viewDir="/"),!u.imageList.length&&!u.childrenDirs.length){await qe(a,a.viewDir);return}await h(a.viewDir)}async function g(){const{viewDir:_}=a;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",_),l.value=!0,await qe(a,_),l.value=!1}return re(()=>{v()}),Q(()=>s,_=>{_===!1&&n.push("/config")}),Q(()=>a.viewDir,async _=>{await h(_),o.value+=1},{deep:!0}),Q(()=>u,_=>{const{viewDir:D}=a,y=je(D,_);y&&(c.value=Xe(D,y,"dir"),f.value=Xe(D,y,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:f.value}))},{deep:!0}),Q(()=>f.value,_=>{E.value=_.filter(D=>D.checked).length>0},{deep:!0}),(_,D)=>{const y=_n,b=me,C=ve,R=Qn("contextmenu"),k=ke;return m(),F("div",Tu,[r("div",Ru,[r("div",Ou,[r("div",Uu,[i(fn,{"bar-type":"management"})]),r("div",Mu,[i(C,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D "+d(a).viewDir+" \u76EE\u5F55\u5185\u5BB9"},{default:p(()=>[i(b,{class:"btn-icon",onClick:Ee(g,["stop"])},{default:p(()=>[i(y)]),_:1},8,["onClick"])]),_:1},8,["content"])])]),te((m(),F("div",Pu,[f.value.length?(m(),A(Lu,{currentDirImageList:f.value,"onUpdate:initImageList":f.value,key:o.value},null,8,["currentDirImageList","onUpdate:initImageList"])):I("",!0),te((m(),F("ul",{class:"image-management-list",style:Se({height:E.value?"calc(100% - 50rem)":"100%"})},[d(a).viewDir!=="/"?(m(),F("li",Vu,[i(Cn,{mode:"back"})])):I("",!0),(m(!0),F(le,null,ie(c.value,(T,X)=>te((m(),F("li",{class:"image-management-item",key:"folder-card-"+T.dir+"-"+X},[i(Cn,{"folder-obj":T},null,8,["folder-obj"])])),[[R,{type:d(we).childDir,dir:T.dir}]])),128)),zu,(m(!0),F(le,null,ie(f.value,(T,X)=>te((m(),F("li",{class:"image-management-item image",key:"image-card-"+X},[i(iu,{"image-obj":T},null,8,["image-obj"])])),[[R,{type:d(we).img,img:T}]])),128))],4)),[[R,{type:d(we).parentDir}]])])),[[k,l.value]])])])}}});var Gu=G(Nu,[["__scopeId","data-v-fac724d4"]]);const Hu=e=>(Fe("data-v-4c853169"),e=e(),be(),e),ju=Hu(()=>r("div",{class:"card-header"},[r("span",null,"\u914D\u7F6E\u81EA\u5B9A\u4E49\u56FE\u7247\u94FE\u63A5\u89C4\u5219")],-1)),Xu=["contenteditable","onFocusout"],Wu={style:{"margin-top":"20px"}},Ku=z({__name:"image-link-rule-config",setup(e){const t=B(()=>V.getters.getUserSettings).value,n=S(),a=Ve({id:"",name:"",rule:"",editable:!0}),s=(l,c)=>{V.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:l,id:c})},u=l=>{Ie.confirm(`<span>\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A</span><strong>${l.name}</strong>`,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{V.dispatch("DEL_IMAGE_LINK_TYPE_RULE",l.id)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},o=l=>{!l||l.validate(c=>{c&&(a.id=J(),V.dispatch("ADD_IMAGE_LINK_TYPE_RULE",JSON.parse(JSON.stringify(a))))})};return(l,c)=>{const f=ea,E=De,h=ta,v=na,g=Ce,_=nt,D=at,y=St;return m(),A(y,null,{header:p(()=>[ju]),default:p(()=>[i(h,{data:d(t).imageLinkType.presetList,style:{width:"100%"}},{default:p(()=>[i(f,{prop:"name",label:"\u7C7B\u578B",width:"120"}),i(f,{label:"CDN \u89C4\u5219"},{default:p(b=>[r("div",{contenteditable:b.row.editable,onFocusout:C=>s(C.target.innerHTML,b.row.id)},O(b.row.rule),41,Xu)]),_:1}),i(f,{label:"\u64CD\u4F5C",width:"80",align:"center"},{default:p(b=>[i(E,{link:"",type:"danger",size:"small",disabled:!b.row.editable,onClick:C=>u(b.row)},{default:p(()=>[$(" \u5220\u9664 ")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),i(v),r("div",Wu,[i(D,{ref_key:"formRef",ref:n,"label-position":"left",model:a,"label-width":"120px",size:"default"},{default:p(()=>[i(_,{label:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B",prop:"name",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:p(()=>[i(g,{modelValue:a.name,"onUpdate:modelValue":c[0]||(c[0]=b=>a.name=b),type:"text"},null,8,["modelValue"])]),_:1}),i(_,{label:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219",prop:"rule",rules:[{required:!0,message:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:p(()=>[i(g,{modelValue:a.rule,"onUpdate:modelValue":c[1]||(c[1]=b=>a.rule=b),type:"text"},null,8,["modelValue"])]),_:1}),i(_,null,{default:p(()=>[i(E,{type:"primary",disabled:!a.name||!a.rule,onClick:c[2]||(c[2]=b=>o(n.value))},{default:p(()=>[$(" \u6DFB\u52A0\u56FE\u7247\u94FE\u63A5\u89C4\u5219 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])]),_:1})}}});var qu=G(Ku,[["__scopeId","data-v-4c853169"]]);const Ye=e=>(Fe("data-v-334e1c0f"),e=e(),be(),e),Ju={class:"compress-config-box"},Yu=Ye(()=>r("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u7247\u538B\u7F29\u7B97\u6CD5\uFF1A",-1)),Zu=Ye(()=>r("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u538B\u7F29\u7387\u8F83\u9AD8\uFF0C\u5927\u591A\u6570\u6D4F\u89C8\u5668\u652F\u6301",-1)),Qu=Ye(()=>r("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D\uFF0C\u6240\u6709\u6D4F\u89C8\u5668\u652F\u6301",-1)),el=Ye(()=>r("span",{class:"desc"},"\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u7387\u6781\u9AD8\uFF0C\u90E8\u5206\u73B0\u4EE3\u6D4F\u89C8\u5668\u652F\u6301",-1)),tl=z({__name:"compress-config-box",props:{disabled:{type:Boolean,default:!1}},emits:["encoder"],setup(e,{expose:t,emit:n}){const a=S(ce.webP),s=o=>{n("encoder",o)},u=()=>{a.value=ce.webP};return re(()=>{n("encoder",a.value)}),t({reset:u}),(o,l)=>{const c=ot,f=st;return m(),F("div",Ju,[Yu,i(f,{disabled:e.disabled,class:"img-encoder-group",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=E=>a.value=E),onChange:s},{default:p(()=>[i(c,{label:d(ce).webP},{default:p(()=>[$(O(d(ce).webP)+" ",1),Zu]),_:1},8,["label"]),i(c,{label:d(ce).mozJPEG},{default:p(()=>[$(O(d(ce).mozJPEG)+" ",1),Qu]),_:1},8,["label"]),i(c,{label:d(ce).avif},{default:p(()=>[$(O(d(ce).avif)+" ",1),el]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])])}}});var wn=G(tl,[["__scopeId","data-v-334e1c0f"]]);const yn=z({__name:"watermark-config-box",props:{isTool:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["watermarkConfig"],setup(e,{emit:t}){const n=Ve({text:"",fontSize:0,position:se.rightBottom,textColor:"",opacity:0}),a=()=>{t("watermarkConfig",n)};return re(()=>{const s=V.getters.getUserSettings.watermark;n.text=s.text,n.textColor=s.textColor,n.fontSize=s.fontSize,n.position=s.position,n.opacity=s.opacity,t("watermarkConfig",n)}),(s,u)=>{const o=Ce,l=nt,c=aa,f=oa,E=sa,h=ot,v=st,g=ua,_=at;return m(),A(_,{class:"watermark-config-form","label-position":"left","label-width":"90rem",disabled:e.disabled},{default:p(()=>[i(g,null,{default:p(()=>[i(c,{span:24},{default:p(()=>[i(l,{label:"\u6C34\u5370\u6587\u5B57"},{default:p(()=>[i(o,{modelValue:n.text,"onUpdate:modelValue":u[0]||(u[0]=D=>n.text=D),placeholder:"\u8BF7\u8F93\u5165\u6C34\u5370\u6587\u5B57\uFF0C\u9650\u5236 20 \u5B57",clearable:"",maxlength:"20",onInput:a},null,8,["modelValue"])]),_:1})]),_:1}),i(c,{span:e.isTool?10:24},{default:p(()=>[i(l,{label:"\u5B57\u4F53\u5927\u5C0F"},{default:p(()=>[i(f,{modelValue:n.fontSize,"onUpdate:modelValue":u[1]||(u[1]=D=>n.fontSize=D),min:40,max:80,step:2,onChange:a},null,8,["modelValue"])]),_:1})]),_:1},8,["span"]),i(c,{span:e.isTool?14:24},{default:p(()=>[i(l,{label:"\u6C34\u5370\u989C\u8272"},{default:p(()=>[i(E,{modelValue:n.textColor,"onUpdate:modelValue":u[2]||(u[2]=D=>n.textColor=D),onChange:a},null,8,["modelValue"])]),_:1})]),_:1},8,["span"]),i(c,{span:e.isTool?10:24},{default:p(()=>[i(l,{label:"\u6C34\u5370\u900F\u660E\u5EA6"},{default:p(()=>[i(f,{modelValue:n.opacity,"onUpdate:modelValue":u[3]||(u[3]=D=>n.opacity=D),precision:1,step:.1,min:.1,max:.9,onChange:a},null,8,["modelValue"])]),_:1})]),_:1},8,["span"]),i(c,{span:e.isTool?14:24},{default:p(()=>[i(l,{label:"\u6C34\u5370\u4F4D\u7F6E"},{default:p(()=>[i(v,{modelValue:n.position,"onUpdate:modelValue":u[4]||(u[4]=D=>n.position=D),onChange:a},{default:p(()=>[i(h,{label:d(se).leftTop},{default:p(()=>[$("\u5DE6\u4E0A\u89D2")]),_:1},8,["label"]),i(h,{label:d(se).leftBottom},{default:p(()=>[$("\u5DE6\u4E0B\u89D2")]),_:1},8,["label"]),i(h,{label:d(se).rightTop},{default:p(()=>[$("\u53F3\u4E0A\u89D2")]),_:1},8,["label"]),i(h,{label:d(se).rightBottom},{default:p(()=>[$("\u53F3\u4E0B\u89D2")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["span"])]),_:1})]),_:1},8,["disabled"])}}});const Ze=e=>(Fe("data-v-5dba0452"),e=e(),be(),e),nl={class:"page-container settings-page-container"},al={class:"setting-list",style:{"margin-top":"10rem"}},ol={class:"setting-item has-desc"},sl=Ze(()=>r("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u54C8\u5E0C\u7801\uFF0C\u786E\u4FDD\u56FE\u7247\u540D\u552F\u4E00\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),ul={class:"setting-item has-desc"},ll=Ze(()=>r("span",{class:"desc"},"\u4E0A\u4F20\u524D\u81EA\u52A8\u7ED9\u56FE\u7247\u540D\u589E\u52A0\u524D\u7F00\uFF0C\u4F8B\u5982\uFF1Aabc-image.jpg\uFF0Cabc- \u4E3A\u524D\u7F00",-1)),il={key:0,class:"setting-item has-desc"},rl={class:"setting-list"},cl={class:"setting-item has-desc"},dl=Ze(()=>r("span",{class:"desc"},"\u5F00\u542F\u540E\u53EF\u4EE5\u81EA\u5B9A\u4E49\u6C34\u5370\u6587\u5B57\u3001\u5B57\u4F53\u5927\u5C0F\u3001\u4F4D\u7F6E\u3001\u989C\u8272\u548C\u900F\u660E\u5EA6",-1)),ml={class:"setting-item"},_l={class:"setting-list"},pl={class:"setting-item has-desc"},fl=Ze(()=>r("span",{class:"desc"},"\u5F00\u542F\u540E\u4E0A\u4F20\u524D\u4F1A\u81EA\u52A8\u538B\u7F29\u56FE\u7247\uFF0C\u6709\u6548\u7F29\u77ED\u56FE\u7247\u52A0\u8F7D\u65F6\u95F4\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F",-1)),gl={class:"setting-item"},hl={class:"setting-list"},vl={class:"setting-item cdn"},El={class:"left"},Fl={class:"right"},bl={class:"setting-item",style:{"margin-top":"20rem"}},Dl={class:"setting-list"},Il={class:"setting-item has-desc"},Cl={class:"desc"},wl={class:"setting-item"},yl={class:"left"},$l={class:"right"},Al={class:"setting-list"},Sl={class:"setting-item"},kl=z({__name:"my-settings",setup(e){const t=B(()=>V.getters.getUserSettings).value,n=()=>{V.dispatch("USER_SETTINGS_PERSIST")},a=()=>{V.dispatch("SET_USER_SETTINGS",Pe({},t)),n()},s=u=>{t.watermark.text=u.text,t.watermark.textColor=u.textColor,t.watermark.opacity=u.opacity,t.watermark.position=u.position,t.watermark.fontSize=u.fontSize,n()};return(u,o)=>{const l=kt,c=Ce,f=la,E=yn,h=St,v=wn,g=It,_=Ct,D=qu,y=ia;return m(),F("div",nl,[i(y,null,{default:p(()=>[i(f,{title:"\u56FE\u7247\u540D\u79F0\u8BBE\u7F6E",name:"1"},{default:p(()=>[r("ul",al,[r("li",ol,[i(l,{modelValue:d(t).defaultHash,"onUpdate:modelValue":o[0]||(o[0]=b=>d(t).defaultHash=b),onChange:n,"active-text":"\u81EA\u52A8\u54C8\u5E0C\u5316"},null,8,["modelValue"]),sl]),r("li",ul,[i(l,{modelValue:d(t).prefixNaming.enable,"onUpdate:modelValue":o[1]||(o[1]=b=>d(t).prefixNaming.enable=b),onChange:n,"active-text":"\u6DFB\u52A0\u524D\u7F00\u547D\u540D"},null,8,["modelValue"]),ll]),d(t).prefixNaming.enable?(m(),F("li",il,[i(c,{class:"prefix-input",modelValue:d(t).prefixNaming.prefix,"onUpdate:modelValue":o[2]||(o[2]=b=>d(t).prefixNaming.prefix=b),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:n,clearable:"",autofocus:""},null,8,["modelValue"])])):I("",!0)])]),_:1}),i(f,{title:"\u56FE\u7247\u6C34\u5370\u8BBE\u7F6E",name:"2"},{default:p(()=>[r("ul",rl,[r("li",cl,[i(l,{modelValue:d(t).watermark.enable,"onUpdate:modelValue":o[3]||(o[3]=b=>d(t).watermark.enable=b),onChange:n,"active-text":"\u662F\u5426\u6DFB\u52A0\u6C34\u5370"},null,8,["modelValue"]),dl]),r("li",ml,[i(h,{class:"settings-item-card"},{default:p(()=>[i(E,{disabled:!d(t).watermark.enable,onWatermarkConfig:s},null,8,["disabled"])]),_:1})])])]),_:1}),i(f,{title:"\u56FE\u7247\u538B\u7F29\u8BBE\u7F6E",name:"3"},{default:p(()=>[r("ul",_l,[r("li",pl,[i(l,{modelValue:d(t).compress.enable,"onUpdate:modelValue":o[4]||(o[4]=b=>d(t).compress.enable=b),onChange:n,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"]),fl]),r("li",gl,[i(h,{class:"settings-item-card"},{default:p(()=>[i(v,{ref:"compressConfigBoxRef",disabled:!d(t).compress.enable,onEncoder:o[5]||(o[5]=b=>{d(t).compress.encoder=b,n()})},null,8,["disabled"])]),_:1})])])]),_:1}),i(f,{title:"\u56FE\u7247\u94FE\u63A5\u89C4\u5219\u914D\u7F6E",name:"4"},{default:p(()=>[r("ul",hl,[r("li",vl,[$(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u89C4\u5219\uFF1A "),i(_,{modelValue:d(t).imageLinkType.selected,"onUpdate:modelValue":o[6]||(o[6]=b=>d(t).imageLinkType.selected=b),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u7C7B\u578B\u89C4\u5219",onChange:a},{default:p(()=>[(m(!0),F(le,null,ie(d(t).imageLinkType.presetList,b=>(m(),A(g,{key:b.name+"-"+b.id,label:b.name,value:b.name,class:"image-link-type-rule-option"},{default:p(()=>[r("span",El,O(b.name),1),r("span",Fl,O(b.rule),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),r("li",bl,[i(D)])])]),_:1}),i(f,{title:"\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\u8BBE\u7F6E",name:"5"},{default:p(()=>[r("ul",Dl,[r("li",Il,[i(l,{modelValue:d(t).imageLinkFormat.enable,"onUpdate:modelValue":o[7]||(o[7]=b=>d(t).imageLinkFormat.enable=b),onChange:n,"active-text":"\u81EA\u52A8\u8F6C\u6362\u56FE\u7247\u94FE\u63A5\u683C\u5F0F"},null,8,["modelValue"]),r("span",Cl," \u4E0A\u4F20\u6210\u529F\u540E\u590D\u5236\u7684\u56FE\u7247\u94FE\u63A5\u65F6\u4F7F\u7528 "+O(d(t).imageLinkFormat.selected)+" \u683C\u5F0F ",1)]),r("li",wl,[$(" \u9009\u62E9\u56FE\u7247\u94FE\u63A5\u683C\u5F0F\uFF1A "),i(_,{modelValue:d(t).imageLinkFormat.selected,"onUpdate:modelValue":o[8]||(o[8]=b=>d(t).imageLinkFormat.selected=b),placeholder:"\u9009\u62E9\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\u683C\u5F0F",onChange:a},{default:p(()=>[(m(!0),F(le,null,ie(d(t).imageLinkFormat.presetList,b=>(m(),A(g,{key:b.name,label:b.name,value:b.name,class:"image-link-type-rule-option"},{default:p(()=>[r("span",yl,O(b.name),1),r("span",$l,O(b.format),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1}),i(f,{title:"\u4E3B\u9898\u8BBE\u7F6E",name:"6"},{default:p(()=>[r("ul",Al,[r("li",Sl,[$(" \u9009\u62E9\u4E3B\u9898\u6A21\u5F0F\uFF1A "),i(_,{modelValue:d(t).theme.mode,"onUpdate:modelValue":o[9]||(o[9]=b=>d(t).theme.mode=b),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:a},{default:p(()=>[i(g,{label:"\u8DDF\u968F\u7CFB\u7EDF",value:d(ae).follow},null,8,["value"]),i(g,{label:"\u767D\u663C\u4E3B\u9898",value:d(ae).light},null,8,["value"]),i(g,{label:"\u6697\u591C\u4E3B\u9898",value:d(ae).dark},null,8,["value"])]),_:1},8,["modelValue"])])])]),_:1})]),_:1})])}}});var Bl=G(kl,[["__scopeId","data-v-5dba0452"]]);const Ll={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},xl=r("path",{fill:"currentColor",d:"M512 64h64v192h-64V64zm0 576h64v192h-64V640zM160 480v-64h192v64H160zm576 0v-64h192v64H736zM249.856 199.04l45.248-45.184L430.848 289.6L385.6 334.848L249.856 199.104zM657.152 606.4l45.248-45.248l135.744 135.744l-45.248 45.248L657.152 606.4zM114.048 923.2L68.8 877.952l316.8-316.8l45.248 45.248l-316.8 316.8zM702.4 334.848L657.152 289.6l135.744-135.744l45.248 45.248L702.4 334.848z"},null,-1),Tl=[xl];function Rl(e,t){return m(),F("svg",Ll,Tl)}var Ol={name:"ep-magic-stick",render:Rl};const Ul={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ml=r("path",{fill:"currentColor",d:"M602.496 240.448A192 192 0 1 1 874.048 512l-316.8 316.8A256 256 0 0 1 195.2 466.752L602.496 59.456l45.248 45.248L240.448 512A192 192 0 0 0 512 783.552l316.8-316.8a128 128 0 1 0-181.056-181.056L353.6 579.904a32 32 0 1 0 45.248 45.248l294.144-294.144l45.312 45.248L444.096 670.4a96 96 0 1 1-135.744-135.744l294.144-294.208z"},null,-1),Pl=[Ml];function Vl(e,t){return m(),F("svg",Ul,Pl)}var zl={name:"ep-paperclip",render:Vl};const Nl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Gl=r("path",{fill:"currentColor",d:"M160 224a32 32 0 0 0-32 32v512a32 32 0 0 0 32 32h704a32 32 0 0 0 32-32V256a32 32 0 0 0-32-32H160zm0-64h704a96 96 0 0 1 96 96v512a96 96 0 0 1-96 96H160a96 96 0 0 1-96-96V256a96 96 0 0 1 96-96z"},null,-1),Hl=r("path",{fill:"currentColor",d:"M704 320a64 64 0 1 1 0 128a64 64 0 0 1 0-128zM288 448h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32zm0 128h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32z"},null,-1),jl=[Gl,Hl];function Xl(e,t){return m(),F("svg",Nl,jl)}var Wl={name:"ep-postcard",render:Xl};const $n=ut([{name:"\u56FE\u7247\u538B\u7F29",desc:"\u4E0D\u9650\u5236\u56FE\u7247\u5927\u5C0F\u548C\u6570\u91CF\uFF0C\u4E0D\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\u7684\u79BB\u7EBF\u6781\u81F4\u538B\u7F29",icon:Ol,uuid:J(),path:"/compress"},{name:"\u56FE\u7247\u8F6C Base64",desc:"\u4E0D\u9650\u5236\u56FE\u7247\u5927\u5C0F\u548C\u6570\u91CF\uFF0C\u5728\u7EBF\u8F6C\u6362\u6210 Base64 \u7F16\u7801",icon:zl,uuid:J(),path:"/base64"},{name:"\u56FE\u7247\u6C34\u5370",desc:"\u81EA\u5B9A\u4E49\u6C34\u5370\u6587\u5B57\u3001\u5B57\u4F53\u5927\u5C0F\u3001\u4F4D\u7F6E\u3001\u989C\u8272\u548C\u900F\u660E\u5EA6",icon:Wl,uuid:J(),path:"/watermark"}]);const Kl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ql=r("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512L340.864 831.872a30.592 30.592 0 0 0 0 42.752a29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),Jl=[ql];function Yl(e,t){return m(),F("svg",Kl,Jl)}var Zl={name:"ep-arrow-right",render:Yl};const Ql={class:"page-container"},ei={key:0,class:"tool-panel"},ti={class:"panel-header"},ni={class:"panel-body"},ai={key:1,class:"toolbox"},oi=["onClick"],si={class:"top"},ui={class:"left flex-center"},li={class:"right"},ii={class:"bottom"},ri=z({__name:"picx-toolbox",setup(e){const t=ut(Zl),n=Be(),a=S("/toolbox"),s=S(!1),u=S({path:"",icon:"",name:"",desc:"",uuid:""}),o=c=>{s.value=!0,u.value=Pe({},c),V.dispatch("TOOLBOX_IMG_LIST_RESET"),n.push(`${a.value}${c.path}`)};Q(()=>n.currentRoute.value,c=>{c.path===a.value&&(s.value=!1)},{deep:!0});const l=()=>{n.isReady().then(()=>{const c=n.currentRoute.value.path;if(a.value!==c){const f=c.substring(c.lastIndexOf("/")),E=$n.value.find(h=>h.path===f);E&&o(E)}})};return re(()=>{l()}),(c,f)=>{const E=ra,h=ca,v=Bt("router-view"),g=me;return m(),F("div",Ql,[s.value?(m(),F("div",ei,[r("div",ti,[i(h,{"separator-icon":t.value},{default:p(()=>[i(E,{to:{path:a.value}},{default:p(()=>[$("\u5DE5\u5177\u7BB1")]),_:1},8,["to"]),i(E,null,{default:p(()=>[$(O(u.value.name),1)]),_:1})]),_:1},8,["separator-icon"])]),r("div",ni,[i(v)])])):(m(),F("ul",ai,[(m(!0),F(le,null,ie(d($n),_=>(m(),F("li",{class:"tool-item",key:_.uuid,onClick:D=>o(_)},[r("div",si,[r("div",ui,[i(g,{size:30},{default:p(()=>[(m(),A(Lt(_.icon)))]),_:2},1024)]),r("div",li,O(_.name),1)]),r("div",ii,O(_.desc),1)],8,oi))),128))]))])}}});var ci=G(ri,[["__scopeId","data-v-4212c022"]]);const vt=e=>(Fe("data-v-19b6b02f"),e=e(),be(),e),di={class:"page-container feedback-page-container"},mi=vt(()=>r("div",{class:"help-info-item description"}," \u{1F3DE}\uFE0F PicX \u662F\u4E00\u6B3E\u57FA\u4E8E GitHub API \u5F00\u53D1\u7684\u56FE\u5E8A\u5DE5\u5177\uFF0C\u63D0\u4F9B\u56FE\u7247\u4E0A\u4F20\u6258\u7BA1\u3001\u751F\u6210\u56FE\u7247\u94FE\u63A5\u548C\u5E38\u7528\u56FE\u7247\u5DE5\u5177\u7BB1\u670D\u52A1\u3002 ",-1)),_i={class:"help-info-item"},pi={class:"help-info-item"},fi={class:"help-info-item"},gi={class:"help-info-item"},hi={class:"help-info-item"},vi=vt(()=>r("div",{class:"help-info-item",style:{"margin-bottom":"2rem"}}," \u{1F381} \u5982\u679C PicX \u5BF9\u4F60\u6709\u5E2E\u52A9\uFF0C\u6B22\u8FCE\u8D5E\u8D4F\u4F5C\u8005\uFF0C\u652F\u6301\u5F00\u6E90\u3002 ",-1)),Ei={class:"help-info-item img"},Fi=vt(()=>r("div",{class:"help-info-item red-text"},[r("strong",null," \u26A0\uFE0F \u90D1\u91CD\u58F0\u660E\uFF1A\u8BF7\u52FF\u4F7F\u7528 PicX \u4E0A\u4F20\u8FDD\u53CD\u4F60\u5F53\u5730\u6CD5\u5F8B\u7684\u56FE\u7247\uFF0C\u6240\u9020\u6210\u7684\u4E00\u5207\u540E\u679C\u4E0E\u4F5C\u8005\u65E0\u5173\u3002 ")],-1)),bi=z({__name:"feedback-info",setup(e){const t=B(()=>ft()==="win"?"Ctrl + D":"Command + D");return(n,a)=>{const s=da,u=ze;return m(),F("div",di,[mi,r("div",_i,[$(" \u{1F30D} \u5EFA\u8BAE\u5C06\u672C\u7AD9\u6DFB\u52A0\u5230\u6D4F\u89C8\u5668\u6536\u85CF\u5939\uFF0C\u65B9\u4FBF\u4E0B\u6B21\u4F7F\u7528\u3002\u5FEB\u6377\u952E\uFF1A"),r("code",null,O(t.value),1)]),r("div",pi,[$(" \u{1F981} \u4F5C\u8005\uFF1A "),i(s,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:p(()=>[$("@XPoet")]),_:1})]),r("div",fi,[$(" \u{1F300} \u4ED3\u5E93\uFF1A "),i(s,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:p(()=>[$(" https://github.com/XPoet/picx ")]),_:1})]),r("div",gi,[$(" \u{1F4D6} \u6587\u6863\uFF1A "),i(s,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:p(()=>[$(" https://picx-docs.xpoet.cn ")]),_:1})]),r("div",hi,[$(" \u{1F4A1} \u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u5982\u9047\u5230\u95EE\u9898\uFF0C\u8BF7\u4ED4\u7EC6\u9605\u8BFB\u6587\u6863\uFF0C\u6216\u8005\u7ED9\u4F5C\u8005\u63D0\xA0 "),i(s,{type:"primary",style:{"font-size":"16rem"},href:"https://github.com/XPoet/picx/issues",target:"_blank"},{default:p(()=>[$(" Issue ")]),_:1}),$(" \xA0\u3002 ")]),vi,r("div",Ei,[i(u,{style:{width:"300rem"},src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/common/appreciation.webp"})]),Fi])}}});var Di=G(bi,[["__scopeId","data-v-19b6b02f"]]);const Ii={class:"img-process-state-card-container"},Ci={class:"img-container","element-loading-text":"\u6B63\u5728\u538B\u7F29..."},wi={class:"info-container"},yi={class:"img-name text-ellipsis"},$i={class:"img-size"},Ai={key:0,class:"finial-file-size file-size-item"},Si=z({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})},cardType:{type:String,default:"compress"}},emits:["remove"],setup(e,{emit:t}){const n=u=>{t("remove",u)},a=u=>{dt(u)},s=u=>{rt(u,()=>{L.success({message:" Base64 \u7F16\u7801\u590D\u5236\u6210\u529F"})})};return(u,o)=>{const l=ze,c=bn,f=me,E=ve,h=ke;return m(),F("div",Ii,[te((m(),F("div",Ci,[i(l,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","data-fancybox":"gallery"},null,8,["src"])])),[[h,e.imgObj.processing]]),r("div",wi,[r("div",yi,O(e.imgObj.finialName||e.imgObj.originalName),1),r("div",$i,[r("div",{class:ne(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize&&e.cardType==="compress"}])},O(d(ye)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize&&e.cardType==="compress"?(m(),F("div",Ai,O(d(ye)(e.imgObj.finialSize))+" KB ",1)):I("",!0)])]),e.imgObj.finialFile?(m(),F("div",{key:0,class:"operate-container flex-center",onClick:o[0]||(o[0]=v=>a(e.imgObj.finialFile))}," \u70B9\u51FB\u4E0B\u8F7D ")):I("",!0),e.cardType==="base64"&&e.imgObj.originalBase64?(m(),F("div",{key:1,class:"operate-container flex-center",onClick:o[1]||(o[1]=v=>s(e.imgObj.originalBase64))}," \u70B9\u51FB\u590D\u5236 Base64 \u7F16\u7801 ")):I("",!0),i(E,{placement:"top",offset:8,content:"\u5220\u9664"},{default:p(()=>[i(f,{class:"del-btn",onClick:o[2]||(o[2]=v=>n(e.imgObj.uuid))},{default:p(()=>[i(c)]),_:1})]),_:1})])}}});var Et=G(Si,[["__scopeId","data-v-4096f068"]]);const ki={class:"compress-tool-container"},Bi={key:0,class:"compress-tool-left"},Li=z({__name:"compress-tool",setup(e){const t=Y(),n=S(null),a=S(null),s=S([]),u=S(ce.webP),o=S(!1),l=S(!1),c=_=>{l.value=!1,o.value=!1,_.forEach(D=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:D.uuid,originalName:D.file.name,originalSize:D.file.size,originalBase64:D.base64,originalFile:D.file})})},f=_=>{l.value=!1,u.value=_},E=()=>{var _,D;t.dispatch("TOOLBOX_IMG_LIST_RESET"),l.value=!1,(_=n.value)==null||_.reset(),(D=a.value)==null||D.reset()},h=async()=>{o.value=!0;for(const _ of s.value)_.processing=!0,_.finialFile=await qt(_.originalFile,u.value),_.finialBase64=await Re(_.finialFile)||"",_.finialSize=_.finialFile.size,_.finialName=_.finialFile.name,_.processing=!1;l.value=!0,o.value=!1},v=()=>{s.value.forEach(_=>{dt(_.finialFile)})},g=_=>{var D;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",_),(D=n.value)==null||D.remove(_)};return Q(()=>t.state.toolboxImageListModule.toolboxImageList,_=>{s.value=_},{immediate:!0,deep:!0}),(_,D)=>{const y=Et,b=Je,C=wn,R=De;return m(),F("div",ki,[s.value.length?(m(),F("div",Bi,[(m(!0),F(le,null,ie(s.value,k=>(m(),A(y,{"img-obj":k,key:k.uuid,onRemove:g},null,8,["img-obj"]))),128))])):I("",!0),r("div",{class:ne(["compress-tool-right",{"no-img":!s.value.length}])},[i(b,{ref_key:"gettingImagesRef",ref:n,onGetImgList:c},null,512),i(C,{ref_key:"compressConfigBoxRef",ref:a,style:{"margin-top":"18rem"},onEncoder:D[0]||(D[0]=k=>f(k))},null,512),r("div",{class:ne(["user-operate",{compressed:l.value&&s.value.length>1}])},[l.value&&s.value.length>1?(m(),A(R,{key:0,plain:"",type:"success",onClick:v},{default:p(()=>[$(" \u6279\u91CF\u4E0B\u8F7D ")]),_:1})):I("",!0),r("div",null,[s.value.length?(m(),A(R,{key:0,plain:"",type:"warning",onClick:E},{default:p(()=>[$(" \u91CD\u7F6E ")]),_:1})):I("",!0),s.value.length?(m(),A(R,{key:1,disabled:o.value||l.value,plain:"",type:"primary",onClick:h},{default:p(()=>[$(" \u538B\u7F29 ")]),_:1},8,["disabled"])):I("",!0)])],2)],2)])}}});var xi=G(Li,[["__scopeId","data-v-3e4ce208"]]);const Ti={class:"base64-tool-container"},Ri={key:0,class:"base64-tool-left"},Oi={class:"user-operate"},Ui=z({__name:"base64-tool",setup(e){const t=Y(),n=S(null),a=S([]),s=l=>{l.forEach(c=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:c.uuid,originalName:c.file.name,originalSize:c.file.size,originalBase64:c.base64})})},u=()=>{var l;t.dispatch("TOOLBOX_IMG_LIST_RESET"),(l=n.value)==null||l.reset()},o=l=>{var c;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",l),(c=n.value)==null||c.remove(l)};return Q(()=>t.state.toolboxImageListModule.toolboxImageList,l=>{a.value=l},{immediate:!0,deep:!0}),(l,c)=>{const f=Et,E=Je,h=De;return m(),F("div",Ti,[a.value.length?(m(),F("div",Ri,[(m(!0),F(le,null,ie(a.value,v=>(m(),A(f,{"card-type":"base64","img-obj":v,key:v.uuid,onRemove:o},null,8,["img-obj"]))),128))])):I("",!0),r("div",{class:ne(["base64-tool-right",{"no-img":!a.value.length}])},[i(E,{ref_key:"gettingImagesRef",ref:n,onGetImgList:s},null,512),r("div",Oi,[a.value.length?(m(),A(h,{key:0,plain:"",type:"warning",onClick:u},{default:p(()=>[$(" \u91CD\u7F6E ")]),_:1})):I("",!0)])],2)])}}});var Mi=G(Ui,[["__scopeId","data-v-b3c16fa6"]]);const Pi={class:"watermark-tool-container"},Vi={key:0,class:"watermark-tool-left"},zi=z({__name:"watermark-tool",setup(e){const t=Y(),n=Ve({enable:!0,text:"",fontSize:0,opacity:0,position:se.rightBottom,textColor:""}),a=S(null),s=S([]),u=S(!1),o=S(!1),l=g=>{o.value=!1,u.value=!1,g.forEach(_=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:_.uuid,originalName:_.file.name,originalSize:_.file.size,originalBase64:_.base64,originalFile:_.file})})},c=g=>{n.text=g.text,n.textColor=g.textColor,n.opacity=g.opacity,n.position=g.position,n.fontSize=g.fontSize,o.value=!1},f=()=>{var g;t.dispatch("TOOLBOX_IMG_LIST_RESET"),o.value=!1,(g=a.value)==null||g.reset()},E=async()=>{u.value=!0;for(const g of s.value)g.processing=!0,g.finialFile=await Xt(g.originalFile,n),g.finialBase64=await Re(g.finialFile)||"",g.finialSize=g.finialFile.size,g.finialName=g.finialFile.name,g.processing=!1;o.value=!0,u.value=!1},h=()=>{s.value.forEach(g=>{dt(g.finialFile)})},v=g=>{var _;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",g),(_=a.value)==null||_.remove(g)};return Q(()=>t.state.toolboxImageListModule.toolboxImageList,g=>{s.value=g},{immediate:!0,deep:!0}),(g,_)=>{const D=Et,y=Je,b=yn,C=De;return m(),F("div",Pi,[s.value.length?(m(),F("div",Vi,[(m(!0),F(le,null,ie(s.value,R=>(m(),A(D,{"img-obj":R,key:R.uuid,"card-type":"watermark",onRemove:v},null,8,["img-obj"]))),128))])):I("",!0),r("div",{class:ne(["watermark-tool-right",{"no-img":!s.value.length}])},[i(y,{ref_key:"gettingImagesRef",ref:a,onGetImgList:l},null,512),i(b,{isTool:!0,onWatermarkConfig:c,style:{"margin-top":"18rem"}}),r("div",{class:ne(["user-operate",{watermarked:o.value&&s.value.length>1}])},[o.value&&s.value.length>1?(m(),A(C,{key:0,plain:"",type:"success",onClick:h},{default:p(()=>[$(" \u6279\u91CF\u4E0B\u8F7D ")]),_:1})):I("",!0),r("div",null,[s.value.length?(m(),A(C,{key:0,plain:"",type:"warning",onClick:f},{default:p(()=>[$(" \u91CD\u7F6E ")]),_:1})):I("",!0),s.value.length?(m(),A(C,{key:1,disabled:u.value||o.value||!n.text,plain:"",type:"primary",onClick:E},{default:p(()=>[$(" \u6DFB\u52A0\u6C34\u5370 ")]),_:1},8,["disabled"])):I("",!0)])],2)],2)])}}});var Ni=G(zi,[["__scopeId","data-v-377e3e52"]]);const $e=" | PicX \u56FE\u5E8A",Gi=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:vo,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${$e}`}},{path:"/upload",name:"upload",component:Rs,meta:{title:`\u56FE\u7247\u4E0A\u4F20${$e}`}},{path:"/management",name:"Management",component:Gu,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${$e}`}},{path:"/settings",name:"settings",component:Bl,meta:{title:`\u6211\u7684\u8BBE\u7F6E${$e}`}},{path:"/toolbox",name:"Toolbox",component:ci,meta:{title:`\u5DE5\u5177\u7BB1${$e}`},children:[{path:"/toolbox/compress",name:"Compress",component:xi},{path:"/toolbox/base64",name:"Base64",component:Mi},{path:"/toolbox/watermark",name:"Watermark",component:Ni}]},{path:"/feedback",name:"feedback",component:Di,meta:{title:`\u5E2E\u52A9\u53CD\u9988${$e}`}}],Oe=ma({history:_a(),routes:Gi});Oe.beforeEach((e,t,n)=>{e.meta.title&&(window.document.title=e.meta.title),n()});const An=()=>{const e=Y(),t=async a=>{await pa(()=>{const s=document.getElementsByTagName("html")[0];a===ae.dark&&(s.classList.remove("light"),s.classList.add("dark")),a===ae.light&&(s.classList.remove("dark"),s.classList.add("light"))})},n=async a=>{a===ae.follow?await t(en()?ae.dark:ae.light):await t(a)};Q(()=>e.getters.getUserSettings.theme.mode,async a=>{await n(a)},{deep:!0,immediate:!0})},Hi={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ji=r("path",{fill:"currentColor",d:"M288 320a224 224 0 1 0 448 0a224 224 0 1 0-448 0zm544 608H160a32 32 0 0 1-32-32v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 0 1-32 32z"},null,-1),Xi=[ji];function Wi(e,t){return m(),F("svg",Hi,Xi)}var Ki={name:"ep-user-filled",render:Wi};const qi={id:"busuanzi_value_site_uv",class:"uv"},Ji={id:"busuanzi_value_site_pv",class:"pv"},Yi=z({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const t=e,n=S(null),a=S(!1),s=B(()=>!0),u=(o,l)=>o.querySelector(`.${l?"u":"p"}v`).innerText;return re(()=>{const o=document.createElement("script");o.async=!0,o.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",n.value.appendChild(o),o.onload=()=>{const l=setTimeout(()=>{u(n.value,t.isuv)&&(a.value=!0),clearTimeout(l)},1500)}}),(o,l)=>te((m(),F("span",{class:"site-count",ref_key:"siteCountDom",ref:n},[$(" \u8D85\u8FC7 "),te(r("span",qi,null,512),[[Le,e.isuv]]),te(r("span",Ji,null,512),[[Le,!e.isuv]]),$(" \u6B21\u88AB\u4F7F\u7528 ")],512)),[[Le,a.value&&s.value]])}});var Zi="./assets/logo.206d082d.png";const Sn=e=>(Fe("data-v-6ab4577e"),e=e(),be(),e),Qi={class:"header"},er={class:"header-left"},tr=Sn(()=>r("div",{class:"logo"},[r("img",{src:Zi,alt:"PicX"})],-1)),nr=Sn(()=>r("div",{class:"title"},"PicX",-1)),ar=[tr,nr],or={class:"website-count"},sr={class:"header-right"},ur={class:"username"},lr={key:0,class:"avatar"},ir={class:"el-dropdown-link"},rr={class:"avatar"},cr=["src","alt"],dr=z({__name:"header-content",setup(e){const t=Be(),n=Y(),a=B(()=>n.getters.getUserConfigInfo).value,s=()=>{!a.logined&&t.currentRoute.value.path!=="/config"&&t.push("/config")},u=()=>{n.dispatch("LOGOUT"),t.push("/config")},o=l=>{switch(l){case"upload":t.push("/");break;case"config":t.push("/config");break;case"management":t.push("/management");break;case"logout":u();break}};return(l,c)=>{var D,y;const f=Yi,E=Ki,h=me,v=yt,g=$t,_=At;return m(),F("header",Qi,[r("div",er,[r("div",{class:"brand",onClick:c[0]||(c[0]=b=>d(t).push("/"))},ar),r("div",or,[i(f,{isuv:!1})])]),r("div",sr,[r("div",{class:"user-info",onClick:s},[r("div",ur,O(d(a).owner?d(a).owner:l.$t("header.notLogin")),1),((D=d(a))==null?void 0:D.avatarUrl)?I("",!0):(m(),F("div",lr,[i(h,{size:22},{default:p(()=>[i(E)]),_:1})])),((y=d(a))==null?void 0:y.avatarUrl)?(m(),A(_,{key:1,trigger:"click",onCommand:o},{dropdown:p(()=>[i(g,null,{default:p(()=>[i(v,{command:"logout"},{default:p(()=>[$(O(l.$t("header.logout")),1)]),_:1})]),_:1})]),default:p(()=>{var b,C;return[r("span",ir,[r("span",rr,[r("img",{src:(b=d(a))==null?void 0:b.avatarUrl,alt:(C=d(a))==null?void 0:C.owner},null,8,cr)])])]}),_:1})):I("",!0)])])])}}});var mr=G(dr,[["__scopeId","data-v-6ab4577e"]]);const _r={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},pr=r("path",{fill:"currentColor",d:"M389.44 768a96.064 96.064 0 0 1 181.12 0H896v64H570.56a96.064 96.064 0 0 1-181.12 0H128v-64h261.44zm192-288a96.064 96.064 0 0 1 181.12 0H896v64H762.56a96.064 96.064 0 0 1-181.12 0H128v-64h453.44zm-320-288a96.064 96.064 0 0 1 181.12 0H896v64H442.56a96.064 96.064 0 0 1-181.12 0H128v-64h133.44z"},null,-1),fr=[pr];function gr(e,t){return m(),F("svg",_r,fr)}var hr={name:"ep-operation",render:gr};const vr={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Er=r("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),Fr=r("path",{fill:"currentColor",d:"m469.952 554.24l52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1),br=[Er,Fr];function Dr(e,t){return m(),F("svg",vr,br)}var Ir={name:"ep-edit",render:Dr};const Cr={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},wr=r("path",{fill:"currentColor",d:"M160 160v704h704V160H160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32z"},null,-1),yr=r("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64q-64 0-64-64t64-64zM185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472l122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888l49.92 39.936l-215.808 269.824l-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072l-.64-.512a32 32 0 0 0-44.8 5.952L185.408 876.992z"},null,-1),$r=[wr,yr];function Ar(e,t){return m(),F("svg",Cr,$r)}var Sr={name:"ep-picture",render:Ar};const kr={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Br=r("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088l-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36l-116.224-25.088l-65.28 113.152l79.68 88.192l-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136l-79.808 88.192l65.344 113.152l116.224-25.024l22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152l24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296l116.288 25.024l65.28-113.152l-79.744-88.192l1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136l79.808-88.128l-65.344-113.152l-116.288 24.96l-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384a192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256a128 128 0 0 0 0-256z"},null,-1),Lr=[Br];function xr(e,t){return m(),F("svg",kr,Lr)}var Tr={name:"ep-setting",render:xr};const Rr={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Or=r("path",{fill:"currentColor",d:"M128 384v448h768V384H128zm-32-64h832a32 32 0 0 1 32 32v512a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V352a32 32 0 0 1 32-32zm64-128h704v64H160zm96-128h512v64H256z"},null,-1),Ur=[Or];function Mr(e,t){return m(),F("svg",Rr,Ur)}var Pr={name:"ep-files",render:Mr};const Vr={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},zr=r("path",{fill:"currentColor",d:"m174.72 855.68l135.296-45.12l23.68 11.84C388.096 849.536 448.576 864 512 864c211.84 0 384-166.784 384-352S723.84 160 512 160S128 326.784 128 512c0 69.12 24.96 139.264 70.848 199.232l22.08 28.8l-46.272 115.584zm-45.248 82.56A32 32 0 0 1 89.6 896l58.368-145.92C94.72 680.32 64 596.864 64 512C64 299.904 256 96 512 96s448 203.904 448 416s-192 416-448 416a461.056 461.056 0 0 1-206.912-48.384l-175.616 58.56z"},null,-1),Nr=r("path",{fill:"currentColor",d:"M512 563.2a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4zm192 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4zm-384 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4z"},null,-1),Gr=[zr,Nr];function Hr(e,t){return m(),F("svg",Vr,Gr)}var jr={name:"ep-chat-dot-round",render:Hr};const Qe=ut([{uuid:J(),name:"nav.config",icon:Ir,isActive:!1,path:"/config",isShow:!0},{uuid:J(),name:"nav.upload",icon:Fn,isActive:!1,path:"/upload",isShow:!0},{uuid:J(),name:"nav.management",icon:Sr,isActive:!1,path:"/management",isShow:!0},{uuid:J(),name:"nav.settings",icon:Tr,isActive:!1,path:"/settings",isShow:!0},{uuid:J(),name:"nav.toolbox",icon:Pr,isActive:!1,path:"/toolbox",isShow:!0},{uuid:J(),name:"nav.feedback",icon:jr,isActive:!1,path:"/feedback",isShow:!0}]);const Xr={class:"nav"},Wr={class:"nav-list"},Kr=["onClick"],qr={class:"nav-content"},Jr={class:"nav-name"},Yr={class:"nav-item quick-actions flex-center"},Zr={class:"nav-content"},Qr={class:"nav-name"},ec={class:"quick-actions-box"},tc=z({__name:"nav-content",setup(e){const t=Be(),n=Y(),a=B(()=>n.getters.getUserConfigInfo).value,s=B(()=>n.getters.getUserSettings).value,u=B(()=>{switch(s.elementPlusSize){case ee.small:return 22;case ee.large:return 30;default:return 26}}),o=S(!1),l=h=>{const{path:v}=h;if(v==="/management"){if(a.selectedRepo===""){L.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93"),t.push("/config");return}if(a.selectedDir===""){L.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A"),t.push("/config");return}}t.push(v)},c=h=>{Qe.value.forEach(v=>{const g=v;return g.isActive=v.path===h||h.includes(v.path),g}),ga(Qe)},f=()=>{n.dispatch("USER_SETTINGS_PERSIST")},E=h=>{s.theme.mode=h?ae.dark:ae.light,f()};return Q(()=>t.currentRoute.value,h=>{c(h.path)}),Q(()=>a.logined,h=>{Qe.value.forEach(v=>{switch(v.path){case"/management":case"/settings":v.isShow=h}})},{deep:!0,immediate:!0}),Q(()=>s.theme.mode,h=>{h===ae.follow?o.value=en():o.value=h===ae.dark},{deep:!0,immediate:!0}),re(()=>{t.isReady().then(()=>{c(t.currentRoute.value.path)})}),(h,v)=>{const g=me,_=hr,D=kt,y=fa;return m(),F("aside",Xr,[r("ul",Wr,[(m(!0),F(le,null,ie(d(Qe),(b,C)=>te((m(),F("li",{class:ne(["nav-item flex-center",{active:b.isActive}]),key:C+b.uuid,onClick:R=>l(b)},[r("div",qr,[i(g,{size:u.value},{default:p(()=>[(m(),A(Lt(b.icon)))]),_:2},1032,["size"]),r("span",Jr,O(h.$t(b.name)),1)])],10,Kr)),[[Le,b.isShow]])),128))]),r("div",Yr,[i(y,{placement:"right",width:200,trigger:"click","show-arrow":!1},{reference:p(()=>[r("div",Zr,[i(g,{size:u.value},{default:p(()=>[i(_)]),_:1},8,["size"]),r("span",Qr,O(h.$t("nav.actions")),1)])]),default:p(()=>[r("div",ec,[i(D,{modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=b=>o.value=b),class:"mb-2","active-text":h.$t("actions.night"),onChange:E},null,8,["modelValue","active-text"]),i(D,{modelValue:d(s).watermark.enable,"onUpdate:modelValue":v[1]||(v[1]=b=>d(s).watermark.enable=b),class:"mb-2","active-text":h.$t("actions.watermark"),onChange:f},null,8,["modelValue","active-text"]),i(D,{modelValue:d(s).compress.enable,"onUpdate:modelValue":v[2]||(v[2]=b=>d(s).compress.enable=b),class:"mb-2","active-text":h.$t("actions.compress"),onChange:f},null,8,["modelValue","active-text"]),i(D,{modelValue:d(s).imageLinkFormat.enable,"onUpdate:modelValue":v[3]||(v[3]=b=>d(s).imageLinkFormat.enable=b),class:"mb-2","active-text":h.$t("actions.transform")+d(s).imageLinkFormat.selected,onChange:f},null,8,["modelValue","active-text"])])]),_:1})])])}}});var nc=G(tc,[["__scopeId","data-v-7c477e9e"]]);const ac={class:"main-container"},oc={class:"top-container"},sc={class:"bottom-container"},uc={class:"bottom-content"},lc={class:"left"},ic={class:"right"},rc=z({__name:"main-container",setup(e){return re(()=>{An()}),(t,n)=>{const a=Bt("router-view");return m(),F("main",ac,[r("div",oc,[i(mr)]),r("div",sc,[r("div",uc,[r("div",lc,[i(nc)]),r("div",ic,[i(a)])])])])}}});var cc=G(rc,[["__scopeId","data-v-c5c7351e"]]);const dc=z({__name:"App",setup(e){const t=Y(),n=S("default"),a=s=>{s<=600?(t==null||t.dispatch("SET_USER_SETTINGS",{elementPlusSize:ee.small}),n.value=ee.small):s<=900?(t==null||t.dispatch("SET_USER_SETTINGS",{elementPlusSize:ee.default}),n.value=ee.default):(t==null||t.dispatch("SET_USER_SETTINGS",{elementPlusSize:ee.large}),n.value=ee.large)};return re(()=>{An(),a(window.innerWidth),window.addEventListener("resize",Oa(s=>{a(s.target.innerWidth)},600))}),(s,u)=>(m(),A(d(va),{size:n.value,"z-index":3e3,locale:d(ha)},{default:p(()=>[i(cc)]),_:1},8,["size","locale"]))}}),mc={notLogin:"\u672A\u767B\u5F55",logout:"\u9000\u51FA\u767B\u5F55"},_c={config:"\u56FE\u5E8A\u914D\u7F6E",upload:"\u4E0A\u4F20\u56FE\u7247",management:"\u56FE\u5E8A\u7BA1\u7406",settings:"\u6211\u7684\u8BBE\u7F6E",toolbox:"\u5DE5\u5177\u7BB1",feedback:"\u5E2E\u52A9\u53CD\u9988",actions:"\u5FEB\u6377\u64CD\u4F5C"},pc={night:"\u6697\u591C\u6A21\u5F0F",watermark:"\u6DFB\u52A0\u6C34\u5370",compress:"\u538B\u7F29\u56FE\u7247",transform:"\u8F6C\u6362 "};var fc={header:mc,nav:_c,actions:pc};const gc={notLogin:"Not Login",logout:"Logout"},hc={config:"Image Hosting Config",upload:"Upload Image",management:"Image Hosting Management",settings:"My Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick actions"},vc={night:"Night Mode",compress:"Compress Image",watermark:"Add Watermark",transform:"Transform "};var Ec={header:gc,nav:hc,actions:vc};const Fc=Ea({locale:"zh-CN",messages:{"zh-CN":fc,"en-US":Ec}});const kn="custom-contextmenu-container";let H=null,Ft=!1;const bc={mounted(e,t){e.addEventListener("contextmenu",n=>{const{dir:a,type:s,img:u}=t.value;n.preventDefault(),n.stopPropagation();const o=B(()=>V.getters.getUserViewDir).value,l=a?`${o==="/"?"":`${o}/`}${a}`:o;H=document.querySelector(`.${kn}`),H||(H=document.createElement("ul"),H.setAttribute("class",kn),H.style.position="fixed",H.style.zIndex="1000",H.innerHTML='<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">\u590D\u5236\u56FE\u7247\u94FE\u63A5</li>',document.body.appendChild(H));const c=H==null?void 0:H.querySelector(".upload-image"),f=H==null?void 0:H.querySelector(".copy-link");s===we.img?(f.style.display="block",c.innerHTML="\u4ECE\u5F53\u524D\u4F4D\u7F6E\u4E0A\u4F20\u65B0\u56FE\u7247"):(f.style.display="none",c.innerHTML=`\u4E0A\u4F20\u56FE\u7247\u5230 < ${l==="/"?"\u6839\u76EE\u5F55":l} > \u76EE\u5F55`);let E=n.clientX,h=n.clientY;const v=H.clientWidth,g=H.clientHeight,_=document.documentElement.clientWidth,D=document.documentElement.clientHeight,y=6;v+E>_&&(E=_-v-y),g+h>D&&(h=D-g-y),H.style.top=`${h}px`,H.style.left=`${E}px`,Ft||(Ft=!0,c==null||c.addEventListener("click",async()=>{const C=l==="/"?q.rootDir:q.repoDir,R=l==="/"?[]:l.split("/");await V.dispatch("SET_USER_CONFIG_INFO",{dirMode:C,selectedDir:l,selectedDirList:R}),await Oe.push("/upload")}),f==null||f.addEventListener("click",async()=>{const C=B(()=>V.getters.getUserConfigInfo).value,R=B(()=>V.getters.getUserSettings).value;Ke(u,C,R)}));const b=()=>{H&&(document.removeEventListener("click",b),document.body.removeChild(H),H=null,Ft=!1)};document.addEventListener("click",b)})}},Dc=e=>{e.directive("contextmenu",bc)},Bn=Fa(dc);Dc(Bn);Bn.use(Oe).use(V,an).use(Fc).mount("#app");
